<!DOCTYPE html>
<html >

<head>

  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>2 Genetic Data | Landscape Genetic Data Analysis</title>
  <meta name="description" content="A textbook for the use of R in spatial genetic data analysis.">
  <meta name="generator" content="bookdown  and GitBook 2.6.7">

  <meta property="og:title" content="2 Genetic Data | Landscape Genetic Data Analysis" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="A textbook for the use of R in spatial genetic data analysis." />
  <meta name="github-repo" content="dyerlab/AMG" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="2 Genetic Data | Landscape Genetic Data Analysis" />
  
  <meta name="twitter:description" content="A textbook for the use of R in spatial genetic data analysis." />
  

<meta name="author" content="Rodney J. Dyer">



  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  
  
<link rel="prev" href="spatial-data.html">
<link rel="next" href="resistance-models.html">
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />







<script src="libs/htmlwidgets-1.3/htmlwidgets.js"></script>
<link href="libs/datatables-css-0.0.0/datatables-crosstalk.css" rel="stylesheet" />
<script src="libs/datatables-binding-0.5/datatables.js"></script>
<link href="libs/dt-core-1.10.16/css/jquery.dataTables.min.css" rel="stylesheet" />
<link href="libs/dt-core-1.10.16/css/jquery.dataTables.extra.css" rel="stylesheet" />
<script src="libs/dt-core-1.10.16/js/jquery.dataTables.min.js"></script>
<link href="libs/crosstalk-1.0.0/css/crosstalk.css" rel="stylesheet" />
<script src="libs/crosstalk-1.0.0/js/crosstalk.min.js"></script>
<script src="libs/d3-4.5.0/d3.min.js"></script>
<script src="libs/dendroNetwork-binding-0.4/dendroNetwork.js"></script>
<script src="libs/forceNetwork-binding-0.4/forceNetwork.js"></script>


<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(data-line-number);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  { background-color: #f8f8f8; }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ef2929; } /* Alert */
code span.an { color: #8f5902; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #c4a000; } /* Attribute */
code span.bn { color: #0000cf; } /* BaseN */
code span.cf { color: #204a87; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4e9a06; } /* Char */
code span.cn { color: #000000; } /* Constant */
code span.co { color: #8f5902; font-style: italic; } /* Comment */
code span.cv { color: #8f5902; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #8f5902; font-weight: bold; font-style: italic; } /* Documentation */
code span.dt { color: #204a87; } /* DataType */
code span.dv { color: #0000cf; } /* DecVal */
code span.er { color: #a40000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #0000cf; } /* Float */
code span.fu { color: #000000; } /* Function */
code span.im { } /* Import */
code span.in { color: #8f5902; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #204a87; font-weight: bold; } /* Keyword */
code span.op { color: #ce5c00; font-weight: bold; } /* Operator */
code span.ot { color: #8f5902; } /* Other */
code span.pp { color: #8f5902; font-style: italic; } /* Preprocessor */
code span.sc { color: #000000; } /* SpecialChar */
code span.ss { color: #4e9a06; } /* SpecialString */
code span.st { color: #4e9a06; } /* String */
code span.va { color: #000000; } /* Variable */
code span.vs { color: #4e9a06; } /* VerbatimString */
code span.wa { color: #8f5902; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="media/style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Frontmatter</a><ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#loading-required-libraries"><i class="fa fa-check"></i>Loading Required Libraries</a></li>
</ul></li>
<li class="chapter" data-level="1" data-path="spatial-data.html"><a href="spatial-data.html"><i class="fa fa-check"></i><b>1</b> Spatial Data</a><ul>
<li class="chapter" data-level="1.1" data-path="spatial-data.html"><a href="spatial-data.html#synopsis"><i class="fa fa-check"></i><b>1.1</b> Synopsis</a></li>
<li class="chapter" data-level="1.2" data-path="spatial-data.html"><a href="spatial-data.html#objectives"><i class="fa fa-check"></i><b>1.2</b> Objectives</a></li>
<li class="chapter" data-level="1.3" data-path="spatial-data.html"><a href="spatial-data.html#logistics-on-data"><i class="fa fa-check"></i><b>1.3</b> Logistics on Data</a></li>
<li class="chapter" data-level="1.4" data-path="spatial-data.html"><a href="spatial-data.html#projections"><i class="fa fa-check"></i><b>1.4</b> Projections</a><ul>
<li class="chapter" data-level="1.4.1" data-path="spatial-data.html"><a href="spatial-data.html#equatorial-projections"><i class="fa fa-check"></i><b>1.4.1</b> Equatorial Projections</a></li>
<li class="chapter" data-level="1.4.2" data-path="spatial-data.html"><a href="spatial-data.html#azimuth-projections"><i class="fa fa-check"></i><b>1.4.2</b> Azimuth Projections</a></li>
<li class="chapter" data-level="1.4.3" data-path="spatial-data.html"><a href="spatial-data.html#polar-conic-projections"><i class="fa fa-check"></i><b>1.4.3</b> Polar Conic Projections</a></li>
<li class="chapter" data-level="1.4.4" data-path="spatial-data.html"><a href="spatial-data.html#miscellaneous-projections"><i class="fa fa-check"></i><b>1.4.4</b> Miscellaneous Projections</a></li>
<li class="chapter" data-level="1.4.5" data-path="spatial-data.html"><a href="spatial-data.html#coordinate-systems"><i class="fa fa-check"></i><b>1.4.5</b> Coordinate Systems</a></li>
<li class="chapter" data-level="1.4.6" data-path="spatial-data.html"><a href="spatial-data.html#projection-summary"><i class="fa fa-check"></i><b>1.4.6</b> Projection Summary</a></li>
</ul></li>
<li class="chapter" data-level="1.5" data-path="spatial-data.html"><a href="spatial-data.html#the-sp-library"><i class="fa fa-check"></i><b>1.5</b> The <code>sp</code> Library</a><ul>
<li class="chapter" data-level="1.5.1" data-path="spatial-data.html"><a href="spatial-data.html#points"><i class="fa fa-check"></i><b>1.5.1</b> Points</a></li>
<li class="chapter" data-level="1.5.2" data-path="spatial-data.html"><a href="spatial-data.html#lines"><i class="fa fa-check"></i><b>1.5.2</b> Lines</a></li>
<li class="chapter" data-level="1.5.3" data-path="spatial-data.html"><a href="spatial-data.html#polygons"><i class="fa fa-check"></i><b>1.5.3</b> Polygons</a></li>
<li class="chapter" data-level="1.5.4" data-path="spatial-data.html"><a href="spatial-data.html#projecting-sp-objects."><i class="fa fa-check"></i><b>1.5.4</b> Projecting <code>sp</code> objects.</a></li>
<li class="chapter" data-level="1.5.5" data-path="spatial-data.html"><a href="spatial-data.html#points-lines-and-polygons-in-ggplot"><i class="fa fa-check"></i><b>1.5.5</b> Points, Lines, and Polygons in ggplot</a></li>
</ul></li>
<li class="chapter" data-level="1.6" data-path="spatial-data.html"><a href="spatial-data.html#rasters"><i class="fa fa-check"></i><b>1.6</b> Rasters</a></li>
<li class="chapter" data-level="1.7" data-path="spatial-data.html"><a href="spatial-data.html#modifying-rasters"><i class="fa fa-check"></i><b>1.7</b> Modifying Rasters</a><ul>
<li class="chapter" data-level="1.7.1" data-path="spatial-data.html"><a href="spatial-data.html#stacks-of-rasters"><i class="fa fa-check"></i><b>1.7.1</b> Stacks of Rasters</a></li>
</ul></li>
<li class="chapter" data-level="1.8" data-path="spatial-data.html"><a href="spatial-data.html#rasters-ggplot"><i class="fa fa-check"></i><b>1.8</b> Rasters &amp; ggplot</a></li>
<li class="chapter" data-level="1.9" data-path="spatial-data.html"><a href="spatial-data.html#d-visualization"><i class="fa fa-check"></i><b>1.9</b> 3D Visualization</a></li>
<li class="chapter" data-level="1.10" data-path="spatial-data.html"><a href="spatial-data.html#saving-exporting-vector-raster-objects"><i class="fa fa-check"></i><b>1.10</b> Saving &amp; Exporting Vector &amp; Raster Objects</a></li>
<li class="chapter" data-level="1.11" data-path="spatial-data.html"><a href="spatial-data.html#raster-manipulation"><i class="fa fa-check"></i><b>1.11</b> Raster Manipulation</a><ul>
<li class="chapter" data-level="1.11.1" data-path="spatial-data.html"><a href="spatial-data.html#cropping-rasters"><i class="fa fa-check"></i><b>1.11.1</b> Cropping Rasters</a></li>
<li class="chapter" data-level="1.11.2" data-path="spatial-data.html"><a href="spatial-data.html#cropping-rasters-via-polygons"><i class="fa fa-check"></i><b>1.11.2</b> Cropping Rasters Via Polygons</a></li>
<li class="chapter" data-level="1.11.3" data-path="spatial-data.html"><a href="spatial-data.html#cropping-rasters-via-convex-hull"><i class="fa fa-check"></i><b>1.11.3</b> Cropping Rasters Via Convex Hull</a></li>
<li class="chapter" data-level="1.11.4" data-path="spatial-data.html"><a href="spatial-data.html#extracting-point-data-from-rasters"><i class="fa fa-check"></i><b>1.11.4</b> Extracting Point Data From Rasters</a></li>
<li class="chapter" data-level="1.11.5" data-path="spatial-data.html"><a href="spatial-data.html#extracting-neighborhood-data-from-rasters"><i class="fa fa-check"></i><b>1.11.5</b> Extracting Neighborhood Data from Rasters</a></li>
<li class="chapter" data-level="1.11.6" data-path="spatial-data.html"><a href="spatial-data.html#reprojecting-rasters"><i class="fa fa-check"></i><b>1.11.6</b> Reprojecting Rasters</a></li>
</ul></li>
<li class="chapter" data-level="1.12" data-path="spatial-data.html"><a href="spatial-data.html#questions"><i class="fa fa-check"></i><b>1.12</b> Questions</a></li>
<li class="chapter" data-level="1.13" data-path="spatial-data.html"><a href="spatial-data.html#appendix---other-plotting-tools"><i class="fa fa-check"></i><b>1.13</b> Appendix - Other Plotting Tools</a><ul>
<li class="chapter" data-level="1.13.1" data-path="spatial-data.html"><a href="spatial-data.html#rasters-ggplot-1"><i class="fa fa-check"></i><b>1.13.1</b> Rasters &amp; ggplot</a></li>
<li class="chapter" data-level="1.13.2" data-path="spatial-data.html"><a href="spatial-data.html#ggmap"><i class="fa fa-check"></i><b>1.13.2</b> ggmap</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="2" data-path="genetic-data.html"><a href="genetic-data.html"><i class="fa fa-check"></i><b>2</b> Genetic Data</a><ul>
<li class="chapter" data-level="2.1" data-path="genetic-data.html"><a href="genetic-data.html#synopsis-1"><i class="fa fa-check"></i><b>2.1</b> Synopsis</a></li>
<li class="chapter" data-level="2.2" data-path="genetic-data.html"><a href="genetic-data.html#objectives-1"><i class="fa fa-check"></i><b>2.2</b> Objectives</a></li>
<li class="chapter" data-level="2.3" data-path="genetic-data.html"><a href="genetic-data.html#genetic-markers-types-and-usage"><i class="fa fa-check"></i><b>2.3</b> Genetic Markers, Types and Usage</a><ul>
<li class="chapter" data-level="2.3.1" data-path="genetic-data.html"><a href="genetic-data.html#loading-external-data"><i class="fa fa-check"></i><b>2.3.1</b> Loading External Data</a></li>
<li class="chapter" data-level="2.3.2" data-path="genetic-data.html"><a href="genetic-data.html#built-in-data-sets"><i class="fa fa-check"></i><b>2.3.2</b> Built-In Data Sets</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="genetic-data.html"><a href="genetic-data.html#allele-frequencies"><i class="fa fa-check"></i><b>2.4</b> Allele Frequencies</a></li>
<li class="chapter" data-level="2.5" data-path="genetic-data.html"><a href="genetic-data.html#hardy-weinberg-equilibrium"><i class="fa fa-check"></i><b>2.5</b> Hardy-Weinberg Equilibrium</a><ul>
<li class="chapter" data-level="2.5.1" data-path="genetic-data.html"><a href="genetic-data.html#genetic-assumptions"><i class="fa fa-check"></i><b>2.5.1</b> Genetic Assumptions</a></li>
<li class="chapter" data-level="2.5.2" data-path="genetic-data.html"><a href="genetic-data.html#punnet-squares"><i class="fa fa-check"></i><b>2.5.2</b> Punnet Squares</a></li>
<li class="chapter" data-level="2.5.3" data-path="genetic-data.html"><a href="genetic-data.html#evolutionary-assumptions"><i class="fa fa-check"></i><b>2.5.3</b> Evolutionary Assumptions</a></li>
<li class="chapter" data-level="2.5.4" data-path="genetic-data.html"><a href="genetic-data.html#the-mechanics"><i class="fa fa-check"></i><b>2.5.4</b> The Mechanics</a></li>
<li class="chapter" data-level="2.5.5" data-path="genetic-data.html"><a href="genetic-data.html#trans-generational-transition-probabilities"><i class="fa fa-check"></i><b>2.5.5</b> Trans-Generational Transition Probabilities</a></li>
<li class="chapter" data-level="2.5.6" data-path="genetic-data.html"><a href="genetic-data.html#consequences-of-hwe"><i class="fa fa-check"></i><b>2.5.6</b> Consequences of HWE</a></li>
</ul></li>
<li class="chapter" data-level="2.6" data-path="genetic-data.html"><a href="genetic-data.html#genetic-diversity"><i class="fa fa-check"></i><b>2.6</b> Genetic Diversity</a><ul>
<li class="chapter" data-level="2.6.1" data-path="genetic-data.html"><a href="genetic-data.html#allelic-diversity"><i class="fa fa-check"></i><b>2.6.1</b> Allelic Diversity</a></li>
<li class="chapter" data-level="2.6.2" data-path="genetic-data.html"><a href="genetic-data.html#genotypic-diversity"><i class="fa fa-check"></i><b>2.6.2</b> Genotypic Diversity</a></li>
<li class="chapter" data-level="2.6.3" data-path="genetic-data.html"><a href="genetic-data.html#samples-from-several-locales"><i class="fa fa-check"></i><b>2.6.3</b> Samples from Several Locales</a></li>
<li class="chapter" data-level="2.6.4" data-path="genetic-data.html"><a href="genetic-data.html#multilocus-diversity"><i class="fa fa-check"></i><b>2.6.4</b> Multilocus Diversity</a></li>
<li class="chapter" data-level="2.6.5" data-path="genetic-data.html"><a href="genetic-data.html#inbreeding"><i class="fa fa-check"></i><b>2.6.5</b> Inbreeding</a></li>
</ul></li>
<li class="chapter" data-level="2.7" data-path="genetic-data.html"><a href="genetic-data.html#rarefaction"><i class="fa fa-check"></i><b>2.7</b> Rarefaction</a><ul>
<li class="chapter" data-level="2.7.1" data-path="genetic-data.html"><a href="genetic-data.html#mapping-diversity"><i class="fa fa-check"></i><b>2.7.1</b> Mapping Diversity</a></li>
</ul></li>
<li class="chapter" data-level="2.8" data-path="genetic-data.html"><a href="genetic-data.html#genetic-distance"><i class="fa fa-check"></i><b>2.8</b> Genetic Distance</a><ul>
<li class="chapter" data-level="2.8.1" data-path="genetic-data.html"><a href="genetic-data.html#individual-genetic-distance"><i class="fa fa-check"></i><b>2.8.1</b> Individual Genetic Distance</a></li>
<li class="chapter" data-level="2.8.2" data-path="genetic-data.html"><a href="genetic-data.html#population-level-genetic-distances"><i class="fa fa-check"></i><b>2.8.2</b> Population-Level Genetic Distances</a></li>
</ul></li>
<li class="chapter" data-level="2.9" data-path="genetic-data.html"><a href="genetic-data.html#genetic-structure"><i class="fa fa-check"></i><b>2.9</b> Genetic Structure</a></li>
<li class="chapter" data-level="2.10" data-path="genetic-data.html"><a href="genetic-data.html#f-statistics-and-thier-ilk"><i class="fa fa-check"></i><b>2.10</b> F-Statistics and Thier Ilk</a><ul>
<li class="chapter" data-level="2.10.1" data-path="genetic-data.html"><a href="genetic-data.html#issues-with-fixation-indices"><i class="fa fa-check"></i><b>2.10.1</b> Issues with Fixation Indices</a></li>
<li class="chapter" data-level="2.10.2" data-path="genetic-data.html"><a href="genetic-data.html#additional-x_st-like-parameters"><i class="fa fa-check"></i><b>2.10.2</b> Additional <span class="math inline">\(X_{ST}\)</span>-like Parameters</a></li>
</ul></li>
<li class="chapter" data-level="2.11" data-path="genetic-data.html"><a href="genetic-data.html#statistical-structure"><i class="fa fa-check"></i><b>2.11</b> Statistical Structure</a><ul>
<li class="chapter" data-level="2.11.1" data-path="genetic-data.html"><a href="genetic-data.html#final-thoughts-on-structure"><i class="fa fa-check"></i><b>2.11.1</b> Final Thoughts on Structure</a></li>
</ul></li>
<li class="chapter" data-level="2.12" data-path="genetic-data.html"><a href="genetic-data.html#questions-1"><i class="fa fa-check"></i><b>2.12</b> Questions</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="resistance-models.html"><a href="resistance-models.html"><i class="fa fa-check"></i><b>3</b> Resistance Models</a><ul>
<li class="chapter" data-level="3.1" data-path="resistance-models.html"><a href="resistance-models.html#synopsis-2"><i class="fa fa-check"></i><b>3.1</b> Synopsis</a></li>
<li class="chapter" data-level="3.2" data-path="resistance-models.html"><a href="resistance-models.html#objectives-2"><i class="fa fa-check"></i><b>3.2</b> Objectives</a></li>
<li class="chapter" data-level="3.3" data-path="resistance-models.html"><a href="resistance-models.html#resistance-costs"><i class="fa fa-check"></i><b>3.3</b> Resistance Costs</a><ul>
<li class="chapter" data-level="3.3.1" data-path="resistance-models.html"><a href="resistance-models.html#working-with-remotely-sensed-data"><i class="fa fa-check"></i><b>3.3.1</b> Working with Remotely Sensed Data</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="resistance-models.html"><a href="resistance-models.html#estimating-distances-on-resistance-rasters"><i class="fa fa-check"></i><b>3.4</b> Estimating Distances on Resistance Rasters</a><ul>
<li class="chapter" data-level="3.4.1" data-path="resistance-models.html"><a href="resistance-models.html#least-cost-distance"><i class="fa fa-check"></i><b>3.4.1</b> Least Cost Distance</a></li>
<li class="chapter" data-level="3.4.2" data-path="resistance-models.html"><a href="resistance-models.html#all-paths-circuitscape-distances"><i class="fa fa-check"></i><b>3.4.2</b> All Paths (CircuitScape) Distances</a></li>
<li class="chapter" data-level="3.4.3" data-path="resistance-models.html"><a href="resistance-models.html#logistical-issues"><i class="fa fa-check"></i><b>3.4.3</b> Logistical Issues</a></li>
<li class="chapter" data-level="3.4.4" data-path="resistance-models.html"><a href="resistance-models.html#pixel-size-and-path-lengths"><i class="fa fa-check"></i><b>3.4.4</b> Pixel Size and Path Lengths</a></li>
<li class="chapter" data-level="3.4.5" data-path="resistance-models.html"><a href="resistance-models.html#scaling-resistance"><i class="fa fa-check"></i><b>3.4.5</b> Scaling Resistance</a></li>
<li class="chapter" data-level="3.4.6" data-path="resistance-models.html"><a href="resistance-models.html#final-thoughts-on-raster-manipulations"><i class="fa fa-check"></i><b>3.4.6</b> Final Thoughts on Raster Manipulations</a></li>
</ul></li>
<li class="chapter" data-level="3.5" data-path="resistance-models.html"><a href="resistance-models.html#resistance-models-1"><i class="fa fa-check"></i><b>3.5</b> Resistance Models</a><ul>
<li class="chapter" data-level="3.5.1" data-path="resistance-models.html"><a href="resistance-models.html#the-mantel-test"><i class="fa fa-check"></i><b>3.5.1</b> The Mantel Test</a></li>
<li class="chapter" data-level="3.5.2" data-path="resistance-models.html"><a href="resistance-models.html#the-partial-mantel"><i class="fa fa-check"></i><b>3.5.2</b> The Partial Mantel</a></li>
<li class="chapter" data-level="3.5.3" data-path="resistance-models.html"><a href="resistance-models.html#distance-regression"><i class="fa fa-check"></i><b>3.5.3</b> Distance Regression</a></li>
<li class="chapter" data-level="3.5.4" data-path="resistance-models.html"><a href="resistance-models.html#model-comparisons-concerns"><i class="fa fa-check"></i><b>3.5.4</b> Model Comparisons &amp; Concerns</a></li>
</ul></li>
<li class="chapter" data-level="3.6" data-path="resistance-models.html"><a href="resistance-models.html#questions-2"><i class="fa fa-check"></i><b>3.6</b> Questions</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="space-networks.html"><a href="space-networks.html"><i class="fa fa-check"></i><b>4</b> Space &amp; Networks</a><ul>
<li class="chapter" data-level="4.1" data-path="space-networks.html"><a href="space-networks.html#synopsis-3"><i class="fa fa-check"></i><b>4.1</b> Synopsis</a></li>
<li class="chapter" data-level="4.2" data-path="space-networks.html"><a href="space-networks.html#objectives-3"><i class="fa fa-check"></i><b>4.2</b> Objectives</a></li>
<li class="chapter" data-level="4.3" data-path="space-networks.html"><a href="space-networks.html#admixture"><i class="fa fa-check"></i><b>4.3</b> Admixture</a></li>
<li class="chapter" data-level="4.4" data-path="space-networks.html"><a href="space-networks.html#ordination"><i class="fa fa-check"></i><b>4.4</b> Ordination</a><ul>
<li class="chapter" data-level="4.4.1" data-path="space-networks.html"><a href="space-networks.html#principal-component-rotations"><i class="fa fa-check"></i><b>4.4.1</b> Principal Component Rotations</a></li>
<li class="chapter" data-level="4.4.2" data-path="space-networks.html"><a href="space-networks.html#hierarchical-clustering"><i class="fa fa-check"></i><b>4.4.2</b> Hierarchical Clustering</a></li>
<li class="chapter" data-level="4.4.3" data-path="space-networks.html"><a href="space-networks.html#interactive-tree-display"><i class="fa fa-check"></i><b>4.4.3</b> Interactive Tree Display</a></li>
</ul></li>
<li class="chapter" data-level="4.5" data-path="space-networks.html"><a href="space-networks.html#networks"><i class="fa fa-check"></i><b>4.5</b> Networks</a><ul>
<li class="chapter" data-level="4.5.1" data-path="space-networks.html"><a href="space-networks.html#node-edge-attributes"><i class="fa fa-check"></i><b>4.5.1</b> Node &amp; Edge Attributes</a></li>
<li class="chapter" data-level="4.5.2" data-path="space-networks.html"><a href="space-networks.html#plotting-a-graphs"><i class="fa fa-check"></i><b>4.5.2</b> Plotting a Graphs</a></li>
</ul></li>
<li class="chapter" data-level="4.6" data-path="space-networks.html"><a href="space-networks.html#mapping-networks"><i class="fa fa-check"></i><b>4.6</b> Mapping Networks</a></li>
<li class="chapter" data-level="4.7" data-path="space-networks.html"><a href="space-networks.html#genetic-distance-graphs"><i class="fa fa-check"></i><b>4.7</b> Genetic Distance Graphs</a></li>
<li class="chapter" data-level="4.8" data-path="space-networks.html"><a href="space-networks.html#population-graphs"><i class="fa fa-check"></i><b>4.8</b> Population Graphs</a></li>
<li class="chapter" data-level="4.9" data-path="space-networks.html"><a href="space-networks.html#adding-data-to-a-graph"><i class="fa fa-check"></i><b>4.9</b> Adding data to a graph</a><ul>
<li class="chapter" data-level="4.9.1" data-path="space-networks.html"><a href="space-networks.html#plotting-a-graph-using-ggplot2-routines"><i class="fa fa-check"></i><b>4.9.1</b> Plotting a graph using <strong>ggplot2</strong> routines</a></li>
<li class="chapter" data-level="4.9.2" data-path="space-networks.html"><a href="space-networks.html#reading-existing-popgraph-files"><i class="fa fa-check"></i><b>4.9.2</b> Reading Existing <strong>popgraph</strong> Files</a></li>
<li class="chapter" data-level="4.9.3" data-path="space-networks.html"><a href="space-networks.html#saving-population-graph-objects"><i class="fa fa-check"></i><b>4.9.3</b> Saving Population Graph Objects</a></li>
<li class="chapter" data-level="4.9.4" data-path="space-networks.html"><a href="space-networks.html#interactive-networks"><i class="fa fa-check"></i><b>4.9.4</b> Interactive Networks</a></li>
<li class="chapter" data-level="4.9.5" data-path="space-networks.html"><a href="space-networks.html#spatial-population-graphs"><i class="fa fa-check"></i><b>4.9.5</b> Spatial Population Graphs</a></li>
<li class="chapter" data-level="4.9.6" data-path="space-networks.html"><a href="space-networks.html#integrating-google-and-ggplot2-for-plotting"><i class="fa fa-check"></i><b>4.9.6</b> Integrating Google and <strong>ggplot2</strong> for Plotting</a></li>
<li class="chapter" data-level="4.9.7" data-path="space-networks.html"><a href="space-networks.html#integrating-raster-maps"><i class="fa fa-check"></i><b>4.9.7</b> Integrating Raster Maps</a></li>
<li class="chapter" data-level="4.9.8" data-path="space-networks.html"><a href="space-networks.html#extracting-spatial-data-using-population-graphs"><i class="fa fa-check"></i><b>4.9.8</b> Extracting Spatial Data Using Population Graphs</a></li>
</ul></li>
<li class="chapter" data-level="4.10" data-path="space-networks.html"><a href="space-networks.html#extracting-graph-theoretic-parameters"><i class="fa fa-check"></i><b>4.10</b> Extracting Graph-Theoretic Parameters</a><ul>
<li class="chapter" data-level="4.10.1" data-path="space-networks.html"><a href="space-networks.html#matrix-representations-of-population-graph-objects"><i class="fa fa-check"></i><b>4.10.1</b> Matrix Representations of Population Graph Objects</a></li>
<li class="chapter" data-level="4.10.2" data-path="space-networks.html"><a href="space-networks.html#edge-specific-parameters"><i class="fa fa-check"></i><b>4.10.2</b> Edge Specific Parameters</a></li>
</ul></li>
<li class="chapter" data-level="4.11" data-path="space-networks.html"><a href="space-networks.html#testing-for-topological-congruence"><i class="fa fa-check"></i><b>4.11</b> Testing for Topological Congruence</a></li>
<li class="chapter" data-level="4.12" data-path="space-networks.html"><a href="space-networks.html#questions-3"><i class="fa fa-check"></i><b>4.12</b> Questions</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="quantitative-genetics.html"><a href="quantitative-genetics.html"><i class="fa fa-check"></i><b>5</b> Quantitative Genetics</a><ul>
<li class="chapter" data-level="5.1" data-path="quantitative-genetics.html"><a href="quantitative-genetics.html#phenotypic-variance"><i class="fa fa-check"></i><b>5.1</b> Phenotypic Variance</a></li>
<li class="chapter" data-level="5.2" data-path="quantitative-genetics.html"><a href="quantitative-genetics.html#data-examples"><i class="fa fa-check"></i><b>5.2</b> Data Examples</a><ul>
<li class="chapter" data-level="5.2.1" data-path="quantitative-genetics.html"><a href="quantitative-genetics.html#measured-traits"><i class="fa fa-check"></i><b>5.2.1</b> Measured Traits</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="quantitative-genetics.html"><a href="quantitative-genetics.html#heritability"><i class="fa fa-check"></i><b>5.3</b> Heritability</a></li>
<li class="chapter" data-level="5.4" data-path="quantitative-genetics.html"><a href="quantitative-genetics.html#questions-4"><i class="fa fa-check"></i><b>5.4</b> Questions</a></li>
</ul></li>
<li class="appendix"><span><b>Appendix</b></span></li>
<li class="chapter" data-level="A" data-path="references-cited.html"><a href="references-cited.html"><i class="fa fa-check"></i><b>A</b> References Cited</a></li>
<li class="chapter" data-level="B" data-path="tidyverse.html"><a href="tidyverse.html"><i class="fa fa-check"></i><b>B</b> <code>tidyverse</code></a><ul>
<li class="chapter" data-level="" data-path="tidyverse.html"><a href="tidyverse.html#preprocessing---dates-and-times"><i class="fa fa-check"></i>Preprocessing - Dates and Times</a></li>
<li class="chapter" data-level="B.0.1" data-path="tidyverse.html"><a href="tidyverse.html#preprocessing---removing-redundancy"><i class="fa fa-check"></i><b>B.0.1</b> Preprocessing - Removing Redundancy</a></li>
<li class="chapter" data-level="B.0.2" data-path="tidyverse.html"><a href="tidyverse.html#manipulating-data"><i class="fa fa-check"></i><b>B.0.2</b> Manipulating Data</a></li>
<li class="chapter" data-level="B.0.3" data-path="tidyverse.html"><a href="tidyverse.html#selecting-subsets-of-data"><i class="fa fa-check"></i><b>B.0.3</b> Selecting Subsets of Data</a></li>
<li class="chapter" data-level="B.0.4" data-path="tidyverse.html"><a href="tidyverse.html#filtering-rows"><i class="fa fa-check"></i><b>B.0.4</b> Filtering Rows</a></li>
<li class="chapter" data-level="B.0.5" data-path="tidyverse.html"><a href="tidyverse.html#selecting-and-ordering"><i class="fa fa-check"></i><b>B.0.5</b> Selecting and Ordering</a></li>
<li class="chapter" data-level="B.0.6" data-path="tidyverse.html"><a href="tidyverse.html#piping-output"><i class="fa fa-check"></i><b>B.0.6</b> Piping Output</a></li>
<li class="chapter" data-level="B.0.7" data-path="tidyverse.html"><a href="tidyverse.html#grouping-summarizing"><i class="fa fa-check"></i><b>B.0.7</b> Grouping &amp; Summarizing</a></li>
<li class="chapter" data-level="B.1" data-path="tidyverse.html"><a href="tidyverse.html#the-ggplot-library"><i class="fa fa-check"></i><b>B.1</b> The <code>ggplot</code> Library</a><ul>
<li class="chapter" data-level="B.1.1" data-path="tidyverse.html"><a href="tidyverse.html#aesthetics"><i class="fa fa-check"></i><b>B.1.1</b> Aesthetics</a></li>
<li class="chapter" data-level="B.1.2" data-path="tidyverse.html"><a href="tidyverse.html#density-plots"><i class="fa fa-check"></i><b>B.1.2</b> Density Plots</a></li>
<li class="chapter" data-level="B.1.3" data-path="tidyverse.html"><a href="tidyverse.html#ggplot-themes"><i class="fa fa-check"></i><b>B.1.3</b> GGPlot Themes</a></li>
<li class="chapter" data-level="B.1.4" data-path="tidyverse.html"><a href="tidyverse.html#histograms"><i class="fa fa-check"></i><b>B.1.4</b> Histograms</a></li>
<li class="chapter" data-level="B.1.5" data-path="tidyverse.html"><a href="tidyverse.html#overlaying-data"><i class="fa fa-check"></i><b>B.1.5</b> Overlaying Data</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="C" data-path="rgdal-rgeos.html"><a href="rgdal-rgeos.html"><i class="fa fa-check"></i><b>C</b> RGDAL &amp; RGEOS</a></li>
<li class="divider"></li>
<li><a href="http://dyerlab.com" target="blank">the Dyer Laboratory</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Landscape Genetic Data Analysis</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="genetic-data" class="section level1">
<h1><span class="header-section-number">2</span> Genetic Data</h1>
<p><img src="media/ch_pepsis.jpg" /></p>
<div id="synopsis-1" class="section level2">
<h2><span class="header-section-number">2.1</span> Synopsis</h2>
<p>This afternoon’s activity is focused on understanding how to work with genetic marker data in R. As a base data type, genotypes are neither normal nor multinomial, but follow an algebra defined by Mendelian inheritance and dictated by mating system and ploidy levels. Here we cover some of the basic material on working with genetic data then dive right into the basis of population genetics—Hardy-Weinberg Equilibrium.</p>
</div>
<div id="objectives-1" class="section level2">
<h2><span class="header-section-number">2.2</span> Objectives</h2>
<ol style="list-style-type: decimal">
<li>Load data in R using the <code>gstudio</code> package.</li>
<li>Estimate allele frequencies for entire data sets as well as among subsets of your data (e.g., regions, populations, or locales).</li>
<li>Determine if populations or subgroups of individuals deviate from expectations under Hardy-Weinberg Equilibrium.</li>
<li>Plot population locales and summary statistics onto maps.</li>
<li>Estimate frequencies and diversity along gradients.</li>
</ol>
<!-- 
########################################################################
 _____                 _   _       ___  ___           _                 
|  __ \               | | (_)      |  \/  |          | |                
| |  \/ ___ _ __   ___| |_ _  ___  | .  . | __ _ _ __| | _____ _ __ ___ 
| | __ / _ \ '_ \ / _ \ __| |/ __| | |\/| |/ _` | '__| |/ / _ \ '__/ __|
| |_\ \  __/ | | |  __/ |_| | (__  | |  | | (_| | |  |   <  __/ |  \__ \
 \____/\___|_| |_|\___|\__|_|\___| \_|  |_/\__,_|_|  |_|\_\___|_|  |___/
########################################################################  
-->
</div>
<div id="genetic-markers-types-and-usage" class="section level2">
<h2><span class="header-section-number">2.3</span> Genetic Markers, Types and Usage</h2>
<p>There are several kinds of genetic markers that can be used in landscape genetic analyses, though some are more practical than others. The limiting factor in deciding on an appropriate marker is the amount of genetic variance in the marker system relative to the features we are testing against. For example, mtDNA markers are rather common in phylogeography and species and subspecies delimitation studies but they evolve at a rate that may be too slow if we are trying to understand contemporary movement patterns. They will not be able to spatially track variation in a way that a more variable and faster mutating marker type would.</p>
<p>For the purposes of this work, we are going to focus on genetic markers rather than sequence data. These are most commonly nuclear markers—though there are cpDNA microsat markers in some species that make them very amenable to landscape genetic studies.</p>
<p>In R, there is not a default data type for genetic markers, and as such we will rely upon one derived in a package created by R. Dyer called <em>gstudio</em>. This package provides not only a default data type <code>locus</code> but also the accompanying functions and routines that are commonly used in the spatial analysis of population genetic data (a subset of which we use in Landscape studies). There are other packages available for genetic analyses, though not all are inter-compatible. In the <em>gstudio</em> package, the <code>locus</code> object is treated just as any other kind of data and can be inserted contained within <code>data.frame</code>, <code>list</code>, and <code>vector</code> containers just like any other kind of data. In doing so, it allows the analysis workflow to proceed in a more streamline fashion. I start by loading the <em>gstudio</em> and <em>tidyverse</em> libraries in.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(gstudio)
<span class="kw">library</span>(tidyverse)</code></pre>
<p>Here are some basic constructs for how to create and manipulate <code>locus</code> objects. A locus is constructed by passing it zero or more alleles.</p>
<pre class="sourceCode r"><code class="sourceCode r">loc0 &lt;-<span class="st"> </span><span class="kw">locus</span>()
loc0</code></pre>
<pre><code>## [1] NA</code></pre>
<p>A locus without alleles is recorded as missing data.<a href="#fn1" class="footnote-ref" id="fnref1"><sup>1</sup></a> Alleles within a locus can be defined as a character types,</p>
<pre class="sourceCode r"><code class="sourceCode r">loc1 &lt;-<span class="st"> </span><span class="kw">locus</span>( <span class="kw">c</span>(<span class="st">&quot;A&quot;</span>,<span class="st">&quot;B&quot;</span>) )
loc1</code></pre>
<pre><code>## [1] &quot;A:B&quot;</code></pre>
<p>numeric types,</p>
<pre class="sourceCode r"><code class="sourceCode r">loc2 &lt;-<span class="st"> </span><span class="kw">locus</span>( <span class="kw">c</span>(<span class="dv">128</span>,<span class="dv">134</span>) )
loc2</code></pre>
<pre><code>## [1] &quot;128:134&quot;</code></pre>
<p>or any other construct</p>
<pre class="sourceCode r"><code class="sourceCode r">loc3 &lt;-<span class="st"> </span><span class="kw">locus</span>( <span class="kw">c</span>(<span class="st">&quot;Minor Allele&quot;</span>, <span class="st">&quot;Major Allele&quot;</span>))
loc3</code></pre>
<pre><code>## [1] &quot;Major Allele:Minor Allele&quot;</code></pre>
<p>And collections of them are stored as vectors.</p>
<pre class="sourceCode r"><code class="sourceCode r">loci &lt;-<span class="st"> </span><span class="kw">c</span>( loc0, loc1, loc2, loc3 )
loci</code></pre>
<pre><code>## [1] NA                          &quot;A:B&quot;                      
## [3] &quot;128:134&quot;                   &quot;Major Allele:Minor Allele&quot;</code></pre>
<div id="loading-external-data" class="section level3">
<h3><span class="header-section-number">2.3.1</span> Loading External Data</h3>
<p>The most way to get genotypes into R is to load them from an external file. In many labs, genotypic data is kept in a spreadsheet-like format (or <code>data.frame</code> in R), where:</p>
<ul>
<li>Each row of the data represent observations on a single individual. This may include information other than genotypes such as spatial coordinates, sampling locale, internal ID number, etc.<br />
</li>
<li>Each column represents a single kind of data measured across all observations. May be missing observations, genotypes, or whatever.</li>
</ul>
<p>Loading the data in and configuring the genotypes as <code>locus</code> objects requires that we identify the columns of the data that are to be translated into <code>locus</code> objects as well as the kind of marker it is representing (AFLP vs. SNP vs. Microsatellite) and the format in which data are currently stored. The following table provides some of the more commonly used types:</p>
<table>
<colgroup>
<col width="13%" />
<col width="86%" />
</colgroup>
<thead>
<tr class="header">
<th>Locus Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>aflp</td>
<td>Amplified Fragment Length Polymorphism with bands encoded as <span class="math inline">\(0\)</span> or <span class="math inline">\(1\)</span>.</td>
</tr>
<tr class="even">
<td>column</td>
<td>Co-dominant markers such as microsatellite loci encoded as one allele per</br> column of data. For diploid data, there are twice as many columns of</br> alleles as there are marker loci.</td>
</tr>
<tr class="odd">
<td>separated</td>
<td>Co-dominant markers in a single column with alleles separated by a pre-defined </br> symbol (default is ‘:’). For species with ploidy &gt; 2, this is the default</br> approach for importing polyploid genotypes.</td>
</tr>
<tr class="even">
<td>snp</td>
<td>Alleles encoded by the number of minor alleles 0, 1, or 2.</td>
</tr>
<tr class="odd">
<td>genepop</td>
<td>Import from the standard (non-fancy) genepop file format.</td>
</tr>
</tbody>
</table>
<p>Here are some examples data files that are included in the <em>gstudio</em> package and how they can be loaded in. The <code>path</code> variable in the following code chunks is the path to the example <em>.csv file that is located in the </em>gstudio* package. For your data, change out the path. In all cases, the structure that is loaded into R is a <code>data.frame</code>.</p>
<p>Here is a raw AFLP file that comes with the <em>gstudio</em> package. The <code>path</code> line is there to identify where the <em>gstudio</em> package is loaded on your computer and within it, there is a folder called <code>extdata</code> and a csv file for aflp-like loci.</p>
<pre class="sourceCode r"><code class="sourceCode r">path &lt;-<span class="st"> </span><span class="kw">system.file</span>(<span class="st">&quot;extdata&quot;</span>, <span class="st">&quot;data_aflp.csv&quot;</span>, <span class="dt">package =</span> <span class="st">&quot;gstudio&quot;</span>)
data &lt;-<span class="st"> </span><span class="kw">read_population</span>( path, <span class="dt">type=</span><span class="st">&quot;aflp&quot;</span>, <span class="dt">locus.columns =</span> <span class="dv">4</span><span class="op">:</span><span class="dv">7</span> )
<span class="kw">summary</span>(data)</code></pre>
<pre><code>##   Population           Latitude       Longitude       Loc1   Loc2  
##  Length:5           Min.   :37.74   Min.   :-122.89   0 :3   0 :3  
##  Class :character   1st Qu.:38.81   1st Qu.:-122.49   1 :2   1 :2  
##  Mode  :character   Median :42.26   Median : -93.47                
##                     Mean   :42.94   Mean   :-101.20                
##                     3rd Qu.:47.15   3rd Qu.: -89.98                
##                     Max.   :48.75   Max.   : -77.16                
##    Loc3     Loc4  
##  1   :3   0   :1  
##  NA&#39;s:2   1   :2  
##           NA&#39;s:2  
##                   
##                   
## </code></pre>
<p>And a two-column microsatellite data file</p>
<pre class="sourceCode r"><code class="sourceCode r">path &lt;-<span class="st"> </span><span class="kw">system.file</span>(<span class="st">&quot;extdata&quot;</span>, <span class="st">&quot;data_2_column.csv&quot;</span>, <span class="dt">package =</span> <span class="st">&quot;gstudio&quot;</span>)
data &lt;-<span class="st"> </span><span class="kw">read_population</span>( path, <span class="dt">type=</span><span class="st">&quot;column&quot;</span>, <span class="dt">locus.columns =</span> <span class="dv">4</span><span class="op">:</span><span class="dv">7</span> )
<span class="kw">summary</span>(data)</code></pre>
<pre><code>##   Population           Latitude       Longitude           Loc1  
##  Length:5           Min.   :37.74   Min.   :-122.89   10:10 :1  
##  Class :character   1st Qu.:38.81   1st Qu.:-122.49   10:12 :1  
##  Mode  :character   Median :42.26   Median : -93.47   10:14 :1  
##                     Mean   :42.94   Mean   :-101.20   12:12 :1  
##                     3rd Qu.:47.15   3rd Qu.: -89.98   12:14 :1  
##                     Max.   :48.75   Max.   : -77.16             
##      Loc2  
##  15:15 :1  
##  15:17 :1  
##  17:17 :1  
##  NA&#39;s  :2  
##            
## </code></pre>
</div>
<div id="built-in-data-sets" class="section level3">
<h3><span class="header-section-number">2.3.2</span> Built-In Data Sets</h3>
<p>There are some built-in data sets (described in <a href="#data-sets"><strong>??</strong></a>) that we will be using and can be loaded into your workspaces using <code>data()</code>. The main one in <em>gstudio</em> is the <em>Arapatus attenuatus</em> data set (referenced in shorthand as <code>arapat</code>). You will become a specialist in desert bark beetle genetics over the course of this workshop.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">data</span>(arapat)
<span class="kw">summary</span>( arapat )</code></pre>
<pre><code>##       Species      Cluster      Population        ID         Latitude    
##  Cape     : 75   CBP-C :150   32     : 19   101_10A:  1   Min.   :23.08  
##  Mainland : 36   NBP-C : 84   75     : 11   101_1A :  1   1st Qu.:24.59  
##  Peninsula:252   SBP-C : 18   Const  : 11   101_2A :  1   Median :26.25  
##                  SCBP-A: 75   12     : 10   101_3A :  1   Mean   :26.25  
##                  SON-B : 36   153    : 10   101_4A :  1   3rd Qu.:27.53  
##                               157    : 10   101_5A :  1   Max.   :29.33  
##                               (Other):292   (Other):357                  
##    Longitude          LTRS          WNT            EN           EF     
##  Min.   :-114.3   01:01 :147   03:03  :108   01:01  :225   01:01 :219  
##  1st Qu.:-113.0   01:02 : 86   01:01  : 82   01:02  : 52   01:02 : 52  
##  Median :-111.5   02:02 :130   01:03  : 77   02:02  : 38   02:02 : 90  
##  Mean   :-111.7                02:02  : 62   03:03  : 22   NA&#39;s  :  2  
##  3rd Qu.:-110.5                03:04  :  8   01:03  :  7               
##  Max.   :-109.1                (Other): 15   (Other): 16               
##                                NA&#39;s   : 11   NA&#39;s   :  3               
##      ZMP           AML           ATPS          MP20    
##  01:01 : 46   08:08  : 51   05:05  :155   05:07  : 64  
##  01:02 : 51   07:07  : 42   03:03  : 69   07:07  : 53  
##  02:02 :233   07:08  : 42   09:09  : 66   18:18  : 52  
##  NA&#39;s  : 33   04:04  : 41   02:02  : 30   05:05  : 48  
##               07:09  : 22   07:09  : 14   05:06  : 22  
##               (Other):142   08:08  :  9   (Other):119  
##               NA&#39;s   : 23   (Other): 20   NA&#39;s   :  5</code></pre>
<p>This species also has a data set for AFLP markers we will use in the very last day of the workshop. These were derived from a subset of populations for reasons we will cover over the week.</p>
<p>In working with data in R, the <em>gstudio</em> library has added several convenience functions that help in manipulation and analyses. Many of the functions in the package make some assumptions about how you have configured your data. These assumptions are here only because I am a very lazy typist and the less I have to type the better my life is. By default, I use the convention that the column of data designating your population labels is called <tt>Population</tt>. I also assume that spatial coordinates are in decimal degrees and are labeled as <tt>Longitude</tt> and <tt>Latitude</tt>. If you use names other than these, you will have to specify what the ‘stratum’ variable is and what the coordinate labels are for your <code>data.frame</code> of genotypes. However, if you use those conventions then you do not need to specify anything and any function that needs stratum or coordinates will have it already set as a default. Here are some easy convenience functions.</p>
<p>Spatial coordinates for strata can be extracted using <code>strata_coordinates()</code>, which takes the centroid of all coordinates in each locale. In the <em>arapat</em> data set, all the individuals in the same population have the same spatial coordinate. Here is what those data look like. Also look at the use of the datatable here, if you present your data in HTML5, you get interactivity! This can be very helpful in your analyses and interactions with colleagues, advisers, and students.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(DT)

<span class="kw">strata_coordinates</span>( arapat ) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">datatable</span>(<span class="dt">rownames=</span><span class="ot">FALSE</span>)</code></pre>
<div id="htmlwidget-2353f2140912bb00fc31" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-2353f2140912bb00fc31">{"x":{"filter":"none","data":[["88","9","84","175","177","173","171","89","159","SFr","160","162","12","161","93","165","169","58","166","64","168","51","Const","77","164","75","163","ESan","153","48","156","157","73","Aqu","Mat","98","101","32","102"],[-114.29353,-113.94486,-113.66787,-113.48973,-113.99141,-112.86985,-113.18263,-113.39991,-113.31609,-112.964,-112.52959,-112.408,-112.66552,-112.986,-112.04613,-112.40948,-111.37833,-111.35475,-112.08062,-111.32638,-111.21563,-111.60056,-111.675,-110.69175,-111.5441,-110.74599,-110.951,-110.36857,-110.46236,-110.27252,-109.989,-110.096,-109.85071,-110.10429,-110.1091,-109.64869,-110.57436,-109.327,-109.12633],[29.32541,29.01457,28.96651,28.72796,28.66056,28.40846,28.22308,28.03661,27.52944,27.3632,27.40498,27.2028,27.18232,27.0367,26.94589,26.24905,26.20876,26.0155,25.91409,25.60521,25.55757,25.34819,25.0247,24.87611,24.74642,24.58843,24.2115,24.45879,24.13389,24.21441,24.0438,24.0195,24.00789,23.2855,23.08984,23.0757,27.90509,26.63783,26.38014]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th>Stratum<\/th>\n      <th>Longitude<\/th>\n      <th>Latitude<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"columnDefs":[{"className":"dt-right","targets":[1,2]}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":[],"jsHooks":[]}</script>
<pre class="sourceCode r"><code class="sourceCode r"><span class="co">#coords &lt;- strata_coordinates( arapat )</span>
<span class="co">#datatable(coords, rownames = FALSE)</span></code></pre>
<p>Creating maps of locales are also such a common feature that <em>gstudio</em> has integration with online mapping providers, allowing you to grab some map tiles from Google, OSM, and other map providers and use them to overlay your data.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(ggmap)</code></pre>
<p>Just as we did yesterday, the <em>ggplot</em> package provides the basic plotting and <em>gstudio</em> provided two geometry layers, <code>geom_strata</code> and <code>geom_strata_label</code> to help out. Notice here also that for both of these layers, you just pass the raw <code>data.frame</code> object to it and as long as you have “Population”, “Latitude”, and “Longitude” columns in it, the functions take care of the plotting for you.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">strata_coordinates</span>( arapat ) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">population_map</span>() -&gt;<span class="st"> </span>map  

map <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">ggmap</span>() <span class="op">+</span><span class="st"> </span>
<span class="st">    </span><span class="kw">geom_strata</span>(<span class="dt">data=</span>arapat) <span class="op">+</span><span class="st"> </span>
<span class="st">    </span><span class="kw">geom_strata_label</span>( <span class="dt">data=</span>arapat )</code></pre>
<p><img src="LGDA_files/figure-html/unnamed-chunk-106-1.png" width="672" /></p>
<!-- ########################################################################
  ___  _ _      _       ______                                    _           
 / _ \| | |    | |      |  ___|                                  (_)          
/ /_\ \ | | ___| | ___  | |_ _ __ ___  __ _ _   _  ___ _ __   ___ _  ___  ___ 
|  _  | | |/ _ \ |/ _ \ |  _| '__/ _ \/ _` | | | |/ _ \ '_ \ / __| |/ _ \/ __|
| | | | | |  __/ |  __/ | | | | |  __/ (_| | |_| |  __/ | | | (__| |  __/\__ \
\_| |_/_|_|\___|_|\___| \_| |_|  \___|\__, |\__,_|\___|_| |_|\___|_|\___||___/
                                         | |                                  
                                         |_|                                  
########################################################################  -->
</div>
</div>
<div id="allele-frequencies" class="section level2">
<h2><span class="header-section-number">2.4</span> Allele Frequencies</h2>
<p>At a base level, the frequency of alleles constitute the most basic type of data relevant to population genetic analyses. You can estimate allele frequencies at several different levels from your data.</p>
<pre class="sourceCode r"><code class="sourceCode r">arapat <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">frequencies</span>() <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">mutate</span>( <span class="dt">Frequency =</span> <span class="kw">round</span>( Frequency, <span class="dv">4</span>) ) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">datatable</span>( <span class="dt">rownames=</span><span class="ot">FALSE</span> )</code></pre>
<div id="htmlwidget-6f9aa71e1a2db7f3065c" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-6f9aa71e1a2db7f3065c">{"x":{"filter":"none","data":[["LTRS","LTRS","WNT","WNT","WNT","WNT","WNT","EN","EN","EN","EN","EN","EF","EF","ZMP","ZMP","AML","AML","AML","AML","AML","AML","AML","AML","AML","AML","AML","AML","AML","ATPS","ATPS","ATPS","ATPS","ATPS","ATPS","ATPS","ATPS","ATPS","ATPS","MP20","MP20","MP20","MP20","MP20","MP20","MP20","MP20","MP20","MP20","MP20","MP20","MP20","MP20","MP20","MP20","MP20","MP20","MP20"],["01","02","01","02","03","04","05","01","02","03","04","05","01","02","01","02","01","02","03","04","05","06","07","08","09","10","11","12","13","01","02","03","04","05","06","07","08","09","10","01","02","03","04","05","06","07","08","09","10","11","12","13","14","15","16","17","18","19"],[0.5234,0.4766,0.358,0.1818,0.4304,0.027,0.0028,0.7153,0.1806,0.0806,0.0181,0.0056,0.6787,0.3213,0.2167,0.7833,0.0015,0.0015,0.0191,0.1265,0.0706,0.0721,0.2353,0.2559,0.1456,0.0147,0.0397,0.0162,0.0015,0.0028,0.0909,0.1956,0.0055,0.4339,0.0041,0.0275,0.0248,0.2107,0.0041,0.0014,0.0084,0.0084,0.0084,0.2709,0.081,0.2626,0.0251,0.0028,0.0168,0.0475,0.0293,0.0223,0.0042,0.0014,0.0014,0.0377,0.162,0.0084]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th>Locus<\/th>\n      <th>Allele<\/th>\n      <th>Frequency<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"columnDefs":[{"className":"dt-right","targets":2}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":[],"jsHooks":[]}</script>
<p>Notice I’m using the pipe opertor <code>%&gt;%</code> that is part of the <em>tidyverse</em> library. If you are not familiar with this, please look at the Appendix to get a better understanding of how it works. Using it will make your programming both easier to read as well as easier to understand.</p>
<p>By default, function in <em>gstudio</em> return the data in a normal <code>data.frame</code> object (most cases) or as a <code>matrix</code> (in the case of genetic distances). This ensures that your workflow can proceed in a normal fashion. However, at times, things like allele frequencies are best handled as matrix objects (e.g., if you are going to use the allele frequencies in multivariate analyses or ordination). For that purpose in particular, we can use the function <code>frequency_matrix</code></p>
<pre class="sourceCode r"><code class="sourceCode r">arapat <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">frequency_matrix</span>( <span class="dt">locus=</span><span class="kw">c</span>(<span class="st">&quot;LTRS&quot;</span>,<span class="st">&quot;ZMP&quot;</span>) ) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">datatable</span>( <span class="dt">rownames =</span> <span class="ot">FALSE</span>)</code></pre>
<div id="htmlwidget-1e652933498041aa5704" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-1e652933498041aa5704">{"x":{"filter":"none","data":[["101","102","12","153","156","157","159","160","161","162","163","164","165","166","168","169","171","173","175","177","32","48","51","58","64","73","75","77","84","88","89","9","93","98","Aqu","Const","ESan","Mat","SFr"],[0.277777777777778,0.3125,0.8,0.15,0,0,0.888888888888889,0.8,0.95,0.95,0.1,0.35,0.7,0.7,0.75,0.65,0.9,0.9,1,1,0.236842105263158,0,0.142857142857143,0.222222222222222,0.7,0,0.0909090909090909,0.6,1,1,0.9,1,0.7,0,0.1875,0.181818181818182,0,0.1,0.777777777777778],[0.722222222222222,0.6875,0.2,0.85,1,1,0.111111111111111,0.2,0.05,0.05,0.9,0.65,0.3,0.3,0.25,0.35,0.1,0.1,0,0,0.763157894736842,1,0.857142857142857,0.777777777777778,0.3,1,0.909090909090909,0.4,0,0,0.1,0,0.3,1,0.8125,0.818181818181818,1,0.9,0.222222222222222],[1,0,0.2,0.1,0,0,0,0.25,0,0.0714285714285714,0,0.4,0.25,0.15,0.7,0.25,0.111111111111111,0.3,0.285714285714286,0.5,0,0,0.428571428571429,0.222222222222222,0.7,0,0,0,0.9375,0.944444444444444,0,1,0.125,0,0,0.1,0,0,0.0555555555555556],[0,0,0.8,0.9,1,1,1,0.75,1,0.928571428571429,1,0.6,0.75,0.85,0.3,0.75,0.888888888888889,0.7,0.714285714285714,0.5,1,1,0.571428571428571,0.777777777777778,0.3,1,1,1,0.0625,0.0555555555555556,1,0,0.875,1,1,0.9,1,1,0.944444444444444]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th>Stratum<\/th>\n      <th>LTRS-01<\/th>\n      <th>LTRS-02<\/th>\n      <th>ZMP-01<\/th>\n      <th>ZMP-02<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"columnDefs":[{"className":"dt-right","targets":[1,2,3,4]}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":[],"jsHooks":[]}</script>
<p>creates a wide data.frame format for analyses. Also notice that I included a specification on which loci I was interested in using–by default it uses all of them for most analysis functions. If you don’t need all the data, no need to calculate all the parameters and then shuffle through all the output.</p>
<p>Individual stratum-level visualization may help interpret landscape-level patterns of genetic structure. To estimate allele frequencies along partitions in your data, you must specify the stratum to use a populations. Here I use the frequency of one of the two alleles at the LTRS locus, estimate by “Population”.</p>
<pre class="sourceCode r"><code class="sourceCode r">arapat <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">frequencies</span>( <span class="dt">loci=</span><span class="st">&quot;LTRS&quot;</span>, <span class="dt">stratum=</span><span class="st">&quot;Population&quot;</span> ) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">filter</span>( Allele <span class="op">==</span><span class="st"> &quot;01&quot;</span> ) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">mutate</span>( <span class="dt">Frequency =</span> <span class="kw">round</span>(Frequency, <span class="dv">3</span>) ) -&gt;<span class="st"> </span>f

<span class="kw">head</span>(f)</code></pre>
<pre><code>##   Stratum Locus Allele Frequency
## 1     101  LTRS     01     0.278
## 2     102  LTRS     01     0.312
## 3      12  LTRS     01     0.800
## 4     153  LTRS     01     0.150
## 5     159  LTRS     01     0.889
## 6     160  LTRS     01     0.800</code></pre>
<p>whose values can be used directly in <code>ggplot</code> as once we merge in the two <code>data.frame</code> objects, combining coordinates and frequencies (to use <code>merge</code> you must have a common column in your data.frame that can serve as an index). The frequency can be displayed as the size of the point</p>
<pre class="sourceCode r"><code class="sourceCode r">arapat <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">strata_coordinates</span>() <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">merge</span>(f) -&gt;<span class="st"> </span>coords

<span class="kw">ggmap</span>( map ) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">geom_point</span>( <span class="kw">aes</span>(<span class="dt">x=</span>Longitude, <span class="dt">y=</span>Latitude, <span class="dt">size=</span>Frequency), <span class="dt">data=</span>coords)</code></pre>
<p><img src="LGDA_files/figure-html/unnamed-chunk-110-1.png" width="672" /></p>
<p>or the color of the point</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggmap</span>( map ) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_point</span>( <span class="kw">aes</span>(<span class="dt">x=</span>Longitude,<span class="dt">y=</span>Latitude,<span class="dt">color=</span>Frequency),<span class="dt">data=</span>coords)</code></pre>
<p><img src="LGDA_files/figure-html/unnamed-chunk-111-1.png" width="672" /></p>
<p>depending upon what you think may be more effective at displaying the spatial patterns.</p>
<p>Another useful display involves taking your frequency data and overlaying it onto Google maps as pie charts. This give you a wide view of all your data. It does, however, require an internet connection…</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">pies_on_map</span>( arapat, <span class="dt">locus=</span><span class="st">&quot;LTRS&quot;</span>)</code></pre>
<p>This should pop up a browser window and show you the output.</p>
<iframe width="640" height="480" src="./pies_on_map.html" frameborder="0" allowfullscreen>
</iframe>
<p>Note the messages about the approximation. This is because the Google maps API has an integer for zoom factor and at times it is not able to get all the points into the field of view using an integer zoom. If this happens to you, you can manually specify the <em>zoom</em> as an optional argument to either function <code>pies_on_map()</code> or <code>population_map()</code>. You also need to be careful with the <code>pies_on_map()</code> function because the way it works is that the background tile is plotted and then I plot the pies on top of it. If you reshape your plot window outside equal x- and y- coordinates (e.g., make it a non-square figure), the spatial location of the pie charts will move! This is a very frustrating thing but it has to do with the way viewports are overlain onto graphical objects in R and I have absolutely <strong>no</strong> control over it. So, the best option is to make the plot square, export it as PNG or TIFF or whatever, then crop as necessary.</p>
<!-- ########################################################################
 _   _               _              _    _      _       _                     
| | | |             | |            | |  | |    (_)     | |                    
| |_| | __ _ _ __ __| |_   _ ______| |  | | ___ _ _ __ | |__   ___ _ __ __ _  
|  _  |/ _` | '__/ _` | | | |______| |/\| |/ _ \ | '_ \| '_ \ / _ \ '__/ _` | 
| | | | (_| | | | (_| | |_| |      \  /\  /  __/ | | | | |_) |  __/ | | (_| | 
\_| |_/\__,_|_|  \__,_|\__, |       \/  \/ \___|_|_| |_|_.__/ \___|_|  \__, | 
                        __/ |                                           __/ | 
                       |___/                                           |___/  
########################################################################  -->
</div>
<div id="hardy-weinberg-equilibrium" class="section level2">
<h2><span class="header-section-number">2.5</span> Hardy-Weinberg Equilibrium</h2>
<p>At the heart of population genetics is the expectation that genotypes will occur at predictable frequencies given a set of assumptions about the underlying population. This is formulated in the enigmatic Hardy-Weinberg Equation, <span class="math inline">\(p^2 + 2pq + q^2 = 1\)</span>.</p>
<p>In this section, we delve in to what that means, where it comes from, and how we can gain biological inferences from data that do not conform to these expectations. The underlying idea of Hardy-Weinberg Equilibrium (HWE for brevity) is that genotypes should occur at frequencies as predicted by probability theory alone IF (and this is the big part), the population we are looking at is mating in particular ways. Lets spend a little time talking about what that means and what these assumptions actually are.</p>
<p>In addition to analyzing your data, you can simulate data in <em>gstudio</em> to mimic several of the processes we will discuss in this section. We will start with the frequencies we calculated in the previous example for the ZMP locus and create a random population with those frequencies.</p>
<pre class="sourceCode r"><code class="sourceCode r">arapat <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">frequencies</span>( <span class="dt">stratum=</span><span class="st">&quot;Species&quot;</span>) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">filter</span>( Locus <span class="op">==</span><span class="st"> &quot;ZMP&quot;</span>, Stratum <span class="op">==</span><span class="st"> &quot;Peninsula&quot;</span> ) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">make_loci</span>( <span class="dt">N =</span> <span class="dv">100</span> ) -&gt;<span class="st"> </span>genotypes
genotypes</code></pre>
<pre><code>##   [1] &quot;02:02&quot; &quot;02:02&quot; &quot;01:02&quot; &quot;01:02&quot; &quot;02:02&quot; &quot;01:02&quot; &quot;01:02&quot; &quot;02:02&quot;
##   [9] &quot;02:02&quot; &quot;01:01&quot; &quot;01:02&quot; &quot;01:02&quot; &quot;01:02&quot; &quot;01:01&quot; &quot;01:02&quot; &quot;01:02&quot;
##  [17] &quot;02:02&quot; &quot;01:01&quot; &quot;02:02&quot; &quot;02:02&quot; &quot;02:02&quot; &quot;02:02&quot; &quot;01:02&quot; &quot;02:02&quot;
##  [25] &quot;01:02&quot; &quot;02:02&quot; &quot;01:02&quot; &quot;01:01&quot; &quot;01:02&quot; &quot;01:01&quot; &quot;02:02&quot; &quot;01:02&quot;
##  [33] &quot;02:02&quot; &quot;01:02&quot; &quot;01:02&quot; &quot;02:02&quot; &quot;01:02&quot; &quot;02:02&quot; &quot;02:02&quot; &quot;01:02&quot;
##  [41] &quot;01:02&quot; &quot;01:02&quot; &quot;02:02&quot; &quot;01:02&quot; &quot;02:02&quot; &quot;02:02&quot; &quot;01:02&quot; &quot;02:02&quot;
##  [49] &quot;01:01&quot; &quot;01:02&quot; &quot;02:02&quot; &quot;01:02&quot; &quot;02:02&quot; &quot;02:02&quot; &quot;02:02&quot; &quot;01:02&quot;
##  [57] &quot;02:02&quot; &quot;02:02&quot; &quot;01:02&quot; &quot;01:02&quot; &quot;02:02&quot; &quot;02:02&quot; &quot;01:02&quot; &quot;02:02&quot;
##  [65] &quot;02:02&quot; &quot;01:02&quot; &quot;01:02&quot; &quot;01:02&quot; &quot;01:02&quot; &quot;02:02&quot; &quot;01:02&quot; &quot;02:02&quot;
##  [73] &quot;02:02&quot; &quot;01:01&quot; &quot;02:02&quot; &quot;02:02&quot; &quot;01:02&quot; &quot;02:02&quot; &quot;02:02&quot; &quot;01:02&quot;
##  [81] &quot;02:02&quot; &quot;01:01&quot; &quot;02:02&quot; &quot;02:02&quot; &quot;02:02&quot; &quot;01:02&quot; &quot;02:02&quot; &quot;01:02&quot;
##  [89] &quot;02:02&quot; &quot;01:01&quot; &quot;02:02&quot; &quot;01:02&quot; &quot;02:02&quot; &quot;02:02&quot; &quot;01:02&quot; &quot;01:02&quot;
##  [97] &quot;01:02&quot; &quot;02:02&quot; &quot;02:02&quot; &quot;02:02&quot;</code></pre>
<div id="genetic-assumptions" class="section level3">
<h3><span class="header-section-number">2.5.1</span> Genetic Assumptions</h3>
<p>Implicit in the description above is a characterization of what constitutes a genotype. For simplicity, as this is the way it was originally defined, we will assume that the species we are looking at is diploid, carrying homologous chromosomes from both parents. Diploidy means that in the adult life stage, each individual has two copies of each allele, one from each parental individual. If diploid is true, we can denote the genotype as <span class="math inline">\(AA\)</span> for the diploid homozygote, <span class="math inline">\(AB\)</span> for the heterozygote, and <span class="math inline">\(BB\)</span> for the other diploid homozygote. If it is not true and the species (at least at that life stage) is haploid, then will will represent the genotype as <span class="math inline">\(A\)</span> or <span class="math inline">\(B\)</span>. Higher levels of ploidy (triploid, tetraploid, hexaploid, etc.) are also possible in many taxa. While the math that follows is essentially the same for these ploidy levels, the actual algebra is a bit more messy. If you are working on taxa with higher ploidy levels, you can do many of the same operations we will focus on in <em>gstudio</em>, consult the documentation for more information. To check the ploidy level in your data (e.g., the number of alleles at a locus) we can use the <code>ploidy()</code> function</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ploidy</span>( genotypes )</code></pre>
<pre><code>##   [1] 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2
##  [36] 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2
##  [71] 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2</code></pre>
<p>In addition to ploidy, genetic constraints on the formulation of the classic HWE assume that the species has two separate sexes, both of which contribute to the next generation. In general, this rules out uniparentally inherited markers such as mtDNA or cpDNA, which are transmitted in most cases by only one of the sexes during reproduction. Examining mating events between diploid individuals is something we should all remember from basic biology and genetics through the use of the Punnet Square. That was a tool designed to teach us about sexual mating, however, it is also a great example of the probabilities of mating we see in sexual reproduction. These probabilities play direct roles in the derivation of HWE.</p>
<p>Two additional constraints arise directly from diploid sexual reproduction. First, we assume that the likelihood of a particular allele is independent of the sex of the individual that contains it. For example, male individuals should have as many alleles (e.g., no sex chromosomes that mix ploidy of genotypes) and alleles at that can occur with equal frequency as the other sex (no sex biased alleles probabilities as may arise from say sex-biased lethals).</p>
<p>Finally, we will invoke both of Mendel’s Laws of Inheritance. His first law states that the alleles at a particular locus are statistically independent from each other. If there is an A allele provided by one parent, the probability of the second allele is either <span class="math inline">\(A\)</span> or <span class="math inline">\(B\)</span> is entirely independent of that first alleles state. The second law, though not necessarily relevant for many HWE applications, deals with the probability of genotypes at two loci. Here we assume that the alleles present at one locus are statistically independent of those at the other locus. We will return to this when we get to linkage but for now lets assume it is a valid assumption.</p>
</div>
<div id="punnet-squares" class="section level3">
<h3><span class="header-section-number">2.5.2</span> Punnet Squares</h3>
<p>A Punnet square is a simple tool used to teach transition probabilities in basic genetics and biology courses. Here is an interactive example using the 2-allele locus (though the tool can handle other ploidy levels) that you can play with to see the kinds of offspring genotypes produced by individual mating.</p>
<p>The population we are examining need to have some specific demographic parameters for HWE to be valid. The most basal assumption that is invoked is that the population size must be very large. In a fact, most of the work of R.A. Fisher and J.B.S. Haldane in developing the modern synthesis relied upon this assumption as well. If population size, <span class="math inline">\(N\)</span>, is too small, then the stochastic change (what we call genetic drift) can have serious influences on allele frequencies.</p>
<p>As a simulation tool, it is very important to understand that when doing stochastic approximations, <span class="math inline">\(N\)</span> has a huge effect. Consider the following:</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">genotype_frequencies</span>( genotypes )</code></pre>
<pre><code>##   Genotype Observed Expected
## 1    01:01        9   8.7025
## 2    01:02       41  41.5950
## 3    02:02       50  49.7025</code></pre>
<p>Here the expected counts are <span class="math inline">\(Np^2\)</span>, <span class="math inline">\(N2pq\)</span>, and <span class="math inline">\(Nq^2\)</span>, conforming to the expectations from HWE, though they do differ a smidge (vernacular for small amount) from the true expectations. When you do simulation work, you need to accept this variability as a component of the system. However, reality also conforms to these same issues, populations are not infinite, populations are finite in size, etc. Perhaps the issue is our portrayal of the natural world using conventions like <span class="math inline">\(N=\infty\)</span>, the genetic neighborhood is defined by a perfect circle with a constant radius, and dispersal follows a continuous and isotropic distance function… These are great to make the equations better for theoreticians but may not capture the kinds of dynamic processes that are most important to landscape genetic studies.</p>
<p>Next, and perhaps this is more for our laziness than any other reason, we assume that the generations do not overlap. This means that the during a single generation, all individuals participate in the mating events, each of which is equally likely to be selected as one participating in a mating event (e.g., random mating). For simplicity, lets denote the frequencies of these genotypes as <span class="math inline">\(f(AA) = P\)</span>, <span class="math inline">\(f(AB) = Q\)</span>, and <span class="math inline">\(f(BB) = R\)</span>. If these individuals are really mating randomly with respect to their genotypes, then the probability of union between any pair is simply the product of their population frequencies.</p>
<table>
<thead>
<tr class="header">
<th align="center"> </th>
<th align="center"><strong>AA</strong></th>
<th align="center"><strong>AB</strong></th>
<th align="center"><strong>BB</strong></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center"><strong>AA</strong></td>
<td align="center"><span class="math inline">\(P^2\)</span></td>
<td align="center"><span class="math inline">\(PQ\)</span></td>
<td align="center"><span class="math inline">\(PR\)</span></td>
</tr>
<tr class="even">
<td align="center"><strong>AB</strong></td>
<td align="center"><span class="math inline">\(PQ\)</span></td>
<td align="center"><span class="math inline">\(Q^2\)</span></td>
<td align="center"><span class="math inline">\(QR\)</span></td>
</tr>
<tr class="odd">
<td align="center"><strong>BB</strong></td>
<td align="center"><span class="math inline">\(PR\)</span></td>
<td align="center"><span class="math inline">\(QR\)</span></td>
<td align="center"><span class="math inline">\(R^2\)</span></td>
</tr>
</tbody>
</table>
<p>More importantly for our simplicity in terminology, at the end of the mating episode, all of the next generations offspring are produced and all adults die. If there were overlapping generations or multiple mating events, we would have to integrate these processes along a continuous timescale rather than treating a single mating generation as a discrete unit. Totally possible, and even fun, but not part of the original formulation of HWE.</p>
<p>Notice how the frequencies changed across mating events (that is exactly what we call <em>genetic drift</em>). The smaller the population size, the larger the deviation across generations.</p>
</div>
<div id="evolutionary-assumptions" class="section level3">
<h3><span class="header-section-number">2.5.3</span> Evolutionary Assumptions</h3>
<p>Finally, we need to invoke evolutionary assumptions to meet the requirements of HWE. First, we must assume that there is <span class="math inline">\(AB\)</span>solutely no mutation. A non-zero mutation rate, <span class="math inline">\(\mu &gt; 0\)</span>, means that the state of a particular allele, say the <span class="math inline">\(A\)</span> allele, has a likelihood of spontaneously becoming something other than the <span class="math inline">\(A\)</span> allele (e.g., the <span class="math inline">\(B\)</span> in this formulation). If HWE is to help us determine the genotype frequencies having one allele spontaneously mutate to another would require that we integrate the mutation rate into HWE directly. Perhaps not that surprisingly, that wasn’t integrated back in the day.</p>
<p>The next assumption has a very similar consequence. Namely, we must assume that the set of individuals that are participating in the mating event in this population is static. Individuals from other populations are not immigrating into this population and individuals within the population are not emigrating out of this population. Just like mutation, and when we get to migration we will see directly how similar these processes are, we will take the easy way out and assume that they do not occur.</p>
<p>The final assumption is based upon selection and is a very easy one to deal with. We simply assume it doesn’t happen. If selection were operating, say an extreme form such as increased lethality of the <span class="math inline">\(AA\)</span> genotype prior to reproduction, then we would have to both specify the way in which selection is operating as well as the its magnitude. We will come back to this topic later but for the simplicity of HWE, we make the assumption that it has no effect.</p>
</div>
<div id="the-mechanics" class="section level3">
<h3><span class="header-section-number">2.5.4</span> The Mechanics</h3>
<p>In a sampled population, we estimate the frequencies of the genotypes as:</p>
<p><span class="math inline">\(P = \frac{N_{AA}}{N}\)</span>,</p>
<p><span class="math inline">\(Q = \frac{N_{AB}}{N}\)</span>,</p>
<p>and</p>
<p><span class="math inline">\(R = \frac{N_{BB}}{N}\)</span></p>
<p>where <span class="math inline">\(N_{XX}\)</span> is the number of <span class="math inline">\(XX\)</span> genotypes and <span class="math inline">\(N\)</span> is the total number of individuals in the sample. Using either <span class="math inline">\(table()\)</span> or <span class="math inline">\(genotype_frequencies\)</span> provides the same information. From these genotype frequencies, we can directly estimate the frequency of each allele (<span class="math inline">\(A\)</span> and <span class="math inline">\(B\)</span>) denoted as p and q as:</p>
<p><span class="math inline">\(f(A) = P + \frac{Q}{2} = p\)</span></p>
<p>and</p>
<p><span class="math inline">\(f(B) = R + \frac{Q}{2} = q\)</span></p>
<p>using the lower case versions of <span class="math inline">\(p\)</span> and <span class="math inline">\(q\)</span>. This is exactly what the <code>frequencies</code> function actually does. Be careful about mixing up the upper and lower case variables. The population geneticist <a href="http://jnason.eeob.iastate.edu">John Nason</a>, makes the connection that this is what it means to “mind our p’s and q’s” though I suspect the etiology of this statement has more to do with liquid volume measurements than population genetics…</p>
<p>Intuitively the formulation denoted above for <span class="math inline">\(p\)</span> and <span class="math inline">\(q\)</span> makes sense as the heterozygote genotype (<span class="math inline">\(AB\)</span>) frequency, <span class="math inline">\(Q\)</span>, is split evenly between the homozygote genotype frequencies, <span class="math inline">\(P\)</span> (for <span class="math inline">\(AA\)</span>) and <span class="math inline">\(R\)</span> (for <span class="math inline">\(BB\)</span>). This can be programatically shown as via the <code>transition_probability()</code> function (takes offspring, mom and dad genotypes):</p>
<pre class="sourceCode r"><code class="sourceCode r">AA &lt;-<span class="st"> </span><span class="kw">locus</span>( <span class="kw">c</span>(<span class="st">&quot;A&quot;</span>,<span class="st">&quot;A&quot;</span>) )
Aa &lt;-<span class="st"> </span><span class="kw">locus</span>( <span class="kw">c</span>(<span class="st">&quot;A&quot;</span>,<span class="st">&quot;a&quot;</span>) )
aa &lt;-<span class="st"> </span><span class="kw">locus</span>( <span class="kw">c</span>(<span class="st">&quot;a&quot;</span>, <span class="st">&quot;a&quot;</span>) )
<span class="kw">transition_probability</span>( AA, Aa, Aa )</code></pre>
<pre><code>## [1] 0.25</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">transition_probability</span>( Aa, Aa, Aa )</code></pre>
<pre><code>## [1] 0.5</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">transition_probability</span>( aa, Aa, Aa )</code></pre>
<pre><code>## [1] 0.25</code></pre>
<p>If these are the only two alleles in the population then there is the additional restriction that <span class="math inline">\(p + q = 1\)</span>. It is easy to expand these methods to more than two alleles, but again the original approximation was specifically set for 2-allele systems.</p>
</div>
<div id="trans-generational-transition-probabilities" class="section level3">
<h3><span class="header-section-number">2.5.5</span> Trans-Generational Transition Probabilities</h3>
<p>If the above expectations hold, then it is possible to iterate through all possible combinations of matings, noting the probability of observing each type, and estimate the frequency of offspring genotypes. This is a bit messy and is probably better displayed in tabular format.</p>
<table>
<thead>
<tr class="header">
<th>Parents</th>
<th align="center"><span class="math inline">\(\mathbf{P(Parents)}\)</span></th>
<th align="center"><span class="math inline">\(\mathbf{P(AA)}\)</span></th>
<th align="center"><span class="math inline">\(\mathbf{P(AB)}\)</span></th>
<th align="center"><span class="math inline">\(\mathbf{P(BB)}\)</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><span class="math inline">\(AA\;x\;AA\)</span></td>
<td align="center"><span class="math inline">\(P^2\)</span></td>
<td align="center"><span class="math inline">\(P^2\)</span></td>
<td align="center"> </td>
<td align="center"> </td>
</tr>
<tr class="even">
<td><span class="math inline">\(AA\;x\;AB\)</span></td>
<td align="center"><span class="math inline">\(PQ\)</span></td>
<td align="center"><span class="math inline">\(PQ/2\)</span></td>
<td align="center"><span class="math inline">\(PQ/2\)</span></td>
<td align="center"> </td>
</tr>
<tr class="odd">
<td><span class="math inline">\(AA\;x\;BB\)</span></td>
<td align="center"><span class="math inline">\(PR\)</span></td>
<td align="center"> </td>
<td align="center"><span class="math inline">\(PR\)</span></td>
<td align="center"> </td>
</tr>
<tr class="even">
<td><span class="math inline">\(AB\;x\;AB\)</span></td>
<td align="center"><span class="math inline">\(Q^2\)</span></td>
<td align="center"><span class="math inline">\(Q^2/4\)</span></td>
<td align="center"><span class="math inline">\(Q^2/2\)</span></td>
<td align="center"><span class="math inline">\(Q^2/4\)</span></td>
</tr>
<tr class="odd">
<td><span class="math inline">\(AB\;x\;BB\)</span></td>
<td align="center"><span class="math inline">\(QR\)</span></td>
<td align="center"> </td>
<td align="center"><span class="math inline">\(QR/2\)</span></td>
<td align="center"><span class="math inline">\(QR/2\)</span></td>
</tr>
<tr class="even">
<td><span class="math inline">\(BB\;x\;BB\)</span></td>
<td align="center"><span class="math inline">\(R^2\)</span></td>
<td align="center"> </td>
<td align="center"> </td>
<td align="center"><span class="math inline">\(R^2\)</span></td>
</tr>
</tbody>
</table>
<p>During the parents generation, the frequencies of <span class="math inline">\(AA\)</span>, <span class="math inline">\(AB\)</span>, and <span class="math inline">\(BB\)</span> were <span class="math inline">\(P\)</span>, <span class="math inline">\(Q\)</span>, and <span class="math inline">\(R\)</span>, defining allele frequencies as <span class="math inline">\(p\)</span> and <span class="math inline">\(q\)</span>. If we invoke all those assumptions about genetic, demographic, and evolutionary processes being absent from mating and production of offspring genotypes (e.g., notice how we do not have any terms in there for mutation, being sex biased, etc.) then the frequency of genotypes at the next generation are defined in the table. For example, at the next generation, say <span class="math inline">\(t+1\)</span>, the frequency of the <span class="math inline">\(AA\)</span> offspring in the population is the sum of probabilities of all matins that produced <span class="math inline">\(AA\)</span> genotypes.</p>
<p><span class="math display">\[
\begin{aligned}
P_{t+1} &amp;= P_{t}^2 + \frac{P_tQ_t}{2} + \frac{Q^2_t}{4} \\\\ 
&amp;= \left( P_t + \frac{Q_t}{2} \right)^2 \\\\
&amp;= p^2
\end{aligned}
\]</span></p>
<p>The other homozygote is the same producing an expectation of the frequency of the <span class="math inline">\(BB\)</span> genotype at <span class="math inline">\(t+1\)</span> of <span class="math inline">\(q^2\)</span>. Similarly for the heterozygote</p>
<p><span class="math display">\[
\begin{aligned}
Q_{t+1} &amp;= \frac{P_tQ_t}{2} + 2P_tR_t + \frac{Q^2_t}{2} + Q_tR_t\\
&amp;= 2\left(P_t + \frac{Q_t}{2} \right)\left(R_t + \frac{Q_t}{2}\right)\\
&amp;= 2pq
\end{aligned}
\]</span></p>
<p>Putting these together, we have an expectation that the genotypes <span class="math inline">\(AA\)</span>, <span class="math inline">\(AB\)</span>, and <span class="math inline">\(BB\)</span> will occur at frequencies of <span class="math inline">\(p^2\)</span>, <span class="math inline">\(2pq\)</span>, and <span class="math inline">\(q^2\)</span>, which is exactly what HWE is. More importantly, it takes only one generation of mating under the assumptions of HWE to return all genotype frequencies to HWE! However, the real population frequencies differ a bit due in part (mostly) the finite size of populations.</p>
<p>Here we can simulate a generation of mating in the previous data. For the following simualtions, we need to have two kinds of data, 1) genotypes, and 2) a unique ID for each individual.</p>
<pre class="sourceCode r"><code class="sourceCode r">data &lt;-<span class="st"> </span><span class="kw">data.frame</span>( <span class="dt">ID=</span><span class="dv">1</span><span class="op">:</span><span class="kw">length</span>(genotypes), <span class="dt">Locus=</span>genotypes )
next_gen &lt;-<span class="st"> </span><span class="kw">mate</span>( data, <span class="dt">N=</span><span class="dv">1</span> )
<span class="kw">table</span>( data<span class="op">$</span>Locus ) <span class="op">/</span><span class="st"> </span><span class="kw">nrow</span>( data )</code></pre>
<pre><code>## 
## 01:01 01:02 02:02 
##  0.09  0.41  0.50</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">table</span>( next_gen<span class="op">$</span>Locus ) <span class="op">/</span><span class="st"> </span><span class="kw">nrow</span>( data )</code></pre>
<pre><code>## 
## 01:01 01:02 02:02 
##  0.12  0.33  0.55</code></pre>
</div>
<div id="consequences-of-hwe" class="section level3">
<h3><span class="header-section-number">2.5.6</span> Consequences of HWE</h3>
<p>The consequences of this are important for our understanding of what processes influence population genetic structure. If none of these forces are operating in the population, then the expectation is that the allele frequencies should predict genotype frequencies. However, if there are some forces that are at work, genetic, demographic, or evolutionary, then the frequencies at which we see these genotypes will deviate from those expectations. Now, biologically speaking, is there any population that conforms exactly to these expectations—–definitely not! However, in many cases populations are large enough to not be influenced by small N, mutation is rare enough to not cause problems, etc.</p>
<p>Using HWE, we can gain some insights into the which sets of forces may be influencing the observed genotype frequencies. In large part, we examine these changes as deviations from expectations with respect to loss or gain of heterozygotes. These expectations, as depicted above, define an idealized situation against which we measure our data. This metric was specifically designed to ignore almost every process and feature that population geneticists would be interested in looking at. If our data are consistent with these expectations then we have no support for the operation of any of these processes. Boring result, no? In a larger sense, the entire field of Population Genetics is devoted to understanding how violations of these assumptions influence population genetic structure. If everything was in HWE and none of these processes were operating, there would be very little for us to do besides DNA fingerprinting and we would all be forensic examiners…</p>
<p>If some of these features are operating, they do have specific expectations on how they would influence the frequency of genotypes (specifically the homozygotes). Specific examples include:</p>
<table>
<thead>
<tr class="header">
<th>Decrease Heterozygosity</th>
<th>Increase Heterozygosity</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Inbreeding</td>
<td>Coding Errors</td>
</tr>
<tr class="even">
<td>Null Alleles</td>
<td>Gametic Gene Flow</td>
</tr>
<tr class="odd">
<td>Positive Assortative Mating</td>
<td>Negative Assortative Mating</td>
</tr>
<tr class="even">
<td>Selection against Heterozygotes</td>
<td>Outbreeding</td>
</tr>
<tr class="odd">
<td>Wahlund Effects</td>
<td>Selection for Heterozygotes</td>
</tr>
</tbody>
</table>
<p>In closing, it should be noted that HWE presented here is easily expandable to loci with more than two alleles as well as for loci with different ploidy levels. The same approaches apply, though it is not as clean to estimate the expectations. In the next section, we look at how we specifically test for HWE in our data.</p>
<p>At a more meta level, one could see the entirety of this topic and population genetics as a discipline as understanding how deviations from HWE manifest and testing for the strength of these deviations. It is becoming less common for people to actually test for HWE as there are many ways that you can have a deficiency (or excess) of heterozygotes and it is probably much better to focus on the specific processes that may causing these deviations rather than the magnitude of the deviation alone. That said, it is a nice organizing principle to use HWE as a straw man argument on which to frame the rest of this topic.</p>
</div>
</div>
<div id="genetic-diversity" class="section level2">
<h2><span class="header-section-number">2.6</span> Genetic Diversity</h2>
<p>At a base level, genetic diversity is the fundamental components upon which evolution operates. Without diversity, there is no evolution and as such species cannot respond to selective pressure. Genetic diversity is a property of sampling locales. It is created and maintained by demographic and evolutionary processes and the history of the organisms being examined. It is also used as a surrogate measure for the consequences of several microevolutionary processes. In this section, we will examine how to estimate genetic diversity within a sample of individuals.</p>
<p>Genetic diversity is estimated in R using the function <code>genetic_diversity()</code> contained within the gstudio library. Here is the documentation for this function. We will walk through the various parameters and illustrate their use with this data set.</p>
<div style="height:250px;white-space:pre-wrap;overflow:scroll;padding:8px;background:#eee;outline: 1px #eee;font-size:small">
<pre>
genetic_diversity {gstudio}                         R Documentation

Estimate genetic diversity

Description

This function is the main one used for estimating genetic diversity among strata. Given the large number of genetic diversity metrics, not all potential types are included.

Usage
genetic_diversity(x, stratum = NULL, mode = c("A", "Ae", "A95", "He", "Ho",
  "Fis", "Pe")[2])

Arguments

x - A data.frame object with locus columns.
stratum - The strata by which the genetic distances are estimated. This can be an optional parameter when estimating distance measures calculated among individuals (default='Population').
mode - The particular genetic diversity metric that you are going to use. The gstudio package currently includes the following individual distance measures:
    A       Number of alleles
    Ae  Effective number of alleles (default)
    A95 Number of alleles with frequency at least five percent
    He  Expected heterozygosity
    Ho  Observed heterozygosity
    Fis Wright's Inbreeding coefficient (size corrected).
    Pe  Locus polymorphic index.

Value

A data.frame with columns for strata, diversity (mode), and potentially P(mode=0).

Author(s)

Rodney J. Dyer rjdyer@vcu.edu

Examples

AA <- locus( c("A","A") )
AB <- locus( c("A","B") )
BB <- locus( c("B","B") )
locus <- c(AA,AA,AA,AA,BB,BB,BB,AB,AB,AA)
locus2 <- c(AB,BB,AA,BB,BB,AB,AB,AA,AA,BB)
Population <- c(rep("Pop-A",5),rep("Pop-B",5))
df <- data.frame( Population, TPI=locus, PGM=locus2 )
genetic_diversity( df, mode="Ae")
</pre>
</div>
<div id="allelic-diversity" class="section level3">
<h3><span class="header-section-number">2.6.1</span> Allelic Diversity</h3>
<p>At the base level, a collection of alleles in a data set provides an estimate of the breadth of genetic variation present. There are many measures commonly used in population genetics, though <span class="math inline">\(A\)</span>, <span class="math inline">\(A_{95}\)</span>, and <span class="math inline">\(A_e\)</span> are quite commonly encountered. These terms are defined as:</p>
<p><em>Frequency Independent Diversity</em> - The parameter <span class="math inline">\(A\)</span> measures the raw count of the number of alleles present in the sample. This is a frequency independent estimate of diversity as it does not matter if the allele is only seen once or is seen hundreds of times in the sample.</p>
<p>Technically, we define this parameter as</p>
<p><span class="math display">\[
A = \ell
\]</span></p>
<p>where <span class="math inline">\(\ell\)</span> is the number of observed alleles. We can estimate allelic diversity by passing the function either a vector of locus objects</p>
<pre class="sourceCode r"><code class="sourceCode r">arapat <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">select</span>( MP20 ) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">genetic_diversity</span>(<span class="dt">mode=</span><span class="st">&quot;A&quot;</span>)</code></pre>
<pre><code>##   Locus  A
## 1  MP20 19</code></pre>
<p>or a <code>data.frame</code> that has one or more columns of data that are locus objects as determined by the <code>column_class()</code> function. The concern associated with using a parameter such as <span class="math inline">\(A\)</span> is that it throws away any information about relative abundance. For example, a data set with alleles found at an abundance of <span class="math inline">\(N_A = 999\)</span> and <span class="math inline">\(N_B = 1\)</span> would have the exact same frequency independent diversity as another sample with <span class="math inline">\(N_A = N_B = 500\)</span>, namely <span class="math inline">\(A = 2\)</span>.</p>
<p><em>Frequency Dependent Diversity</em> - A slightly more stringent approach may be to estimate the diversity of alleles in a frequency dependent fashion, specifying a particular cutoff. The parameter <span class="math inline">\(A_{95}\)</span> is a common parameter that provides a count of the number of alleles present in a sample whose frequencies exceed a threshold of 5%.</p>
<p><span class="math display">\[
A_{95} = \left| A_{freq(\ell)&gt;0.05} \right|
\]</span></p>
<p>This threshold is entirely arbitrary in the same way that we use <span class="math inline">\(\alpha=0.05\)</span> as a cutoff in the teaching of formalized hypothesis testing. It could just as easily be 3%, 1%, or 10% but has a historical trajectory in its current form. The <span class="math inline">\(A_{95}\)</span> parameter does remove some of the problems associated with rare alleles in our data sets as is shown by comparing the diversity of the most allele rich locus MP20 using <span class="math inline">\(A\)</span></p>
<pre class="sourceCode r"><code class="sourceCode r">arapat <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">select</span>( MP20 ) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">genetic_diversity</span>(<span class="dt">mode=</span><span class="st">&quot;A&quot;</span>)</code></pre>
<pre><code>##   Locus  A
## 1  MP20 19</code></pre>
<p>and <span class="math inline">\(A_{95}\)</span></p>
<pre class="sourceCode r"><code class="sourceCode r">arapat <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">select</span>( MP20 ) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">genetic_diversity</span>( <span class="dt">mode=</span><span class="st">&quot;A95&quot;</span>)</code></pre>
<pre><code>##   Locus A95
## 1  MP20   4</code></pre>
<p>Here 15 of the alleles we observed in the full data set occurred at a frequency less than 5%!</p>
<p><em>Effective Number of Alleles</em> - Given the arbitrary nature of the cutoff for <span class="math inline">\(A_{95}\)</span>, a more parsimonious approach may by one that measures the contribution of each allele to diversity in proportion to its frequency. This is <span class="math inline">\(A_e\)</span> and it is defined as:</p>
<p><span class="math display">\[
A_e = \frac{1}{\sum_{i=1}^\ell p_i^2}
\]</span></p>
<p>and is the default mode of diversity provided by the <code>genetic_diversity()</code> function (e.g., the one you get if you do not specify <code>mode=</code>).</p>
<pre class="sourceCode r"><code class="sourceCode r">arapat <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">genetic_diversity</span>( <span class="dt">mode=</span><span class="st">&quot;Ae&quot;</span> )</code></pre>
<pre><code>##   Locus       Ae
## 1  LTRS 1.995623
## 2   WNT 2.880450
## 3    EN 1.814656
## 4    EF 1.773533
## 5   ZMP 1.513877
## 6   AML 5.860583
## 7  ATPS 3.563347
## 8  MP20 5.511837</code></pre>
<p>Notice that <span class="math inline">\(A \ge A_e \ge A_{95}\)</span>, as <span class="math inline">\(A_e\)</span> integrates the contributions of those low frequency alleles. None of these parameters are perfect, though all provide some measurement of diversity at the level of the allele.</p>
</div>
<div id="genotypic-diversity" class="section level3">
<h3><span class="header-section-number">2.6.2</span> Genotypic Diversity</h3>
<p>In addition to diversity at the level of alleles, we also can estimate diversity at the level of the genotype. There are several parameters that can be derived for genotypic diversity but the most common are observed and expected heterozygosity. Observed heterozygosity is simply the fraction of all genotypes in the sample that are not homozygotes.</p>
<p><span class="math display">\[
H_O = \frac{N_{ij}}{N}
\]</span></p>
<p>where <span class="math inline">\(N_{ij}\)</span> is the count of all heterozygous genotypes. The <code>mode=&quot;Ho&quot;</code> option in <code>genetic_diversity()</code> returns these values.</p>
<pre class="sourceCode r"><code class="sourceCode r">arapat <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">genetic_diversity</span>(<span class="dt">mode=</span><span class="st">&quot;Ho&quot;</span>) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">mutate</span>( <span class="dt">Ho =</span> <span class="kw">round</span>( Ho, <span class="dv">4</span> ) )</code></pre>
<pre><code>##   Locus     Ho
## 1  LTRS 0.2369
## 2   WNT 0.2784
## 3    EN 0.2056
## 4    EF 0.1440
## 5   ZMP 0.1545
## 6   AML 0.3706
## 7  ATPS 0.0854
## 8  MP20 0.4469</code></pre>
<p>The second parameter, expected heterozygosity (<span class="math inline">\(H_e\)</span>), is slightly different in that it is a parameter that needs to be estimated from data. It represents the fraction of genotypes in the data set that are expected to be heterozygous, if the sample is in equilibrium. The value for this function depends upon the data that you are estimating and how it is configured. If it is estimated from a single locale, then the parameter can be estimated directly as the expected fraction that are not homozygous.</p>
<p><span class="math display">\[
H_E = 1 - \sum_{i=1}^\ell p_i^2
\]</span></p>
<p>(where <span class="math inline">\(\ell\)</span> is the number of alleles at the locus). Here is an example of expected heterozygosity for the LTRS and MP20 loci.</p>
<pre class="sourceCode r"><code class="sourceCode r">arapat <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">genetic_diversity</span>( <span class="dt">mode=</span><span class="st">&quot;he&quot;</span>) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">filter</span>( Locus <span class="op">%in%</span><span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;LTRS&quot;</span>,<span class="st">&quot;MP20&quot;</span>))</code></pre>
<pre><code>##   Locus        he
## 1  LTRS 0.4989034
## 2  MP20 0.8185723</code></pre>
<p>which is identical to</p>
<pre class="sourceCode r"><code class="sourceCode r">arapat <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">select</span>( LTRS, MP20 ) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">genetic_diversity</span>( <span class="dt">mode=</span><span class="st">&quot;he&quot;</span>) </code></pre>
<p>but I filter the rows of the results in the former whereas I only grab the locus columns for the two loci before estimating diversity in the latter.</p>
<p>In an ideal world, we would be able to have enough resources to sample for these parameters with so many individuals, they would be well behaved. Unfortunately, we do not live in the real world and in many cases our ability to sample lots of individuals is limited. This problem is not a new thing, we estimate the sums of square and divide by <span class="math inline">\(N-1\)</span> instead of <span class="math inline">\(N\)</span> because if we we use the later, we are producing a biased estimate. Unless you are working with <em>all</em> the samples, every time we make population genetic inferences we will be doing so on a sub-sample of the total data available. The <code>arapat</code> data set is no where near a major component of the species, it is only a sample. From this sample, we <em>estimate</em> allele frequencies on which we derive our <em>estimates</em> of parameters such as <span class="math inline">\(H_E\)</span>. As such, if we used the formulas above to estimate everything in every study, we would have biased estimators of… pretty much everything. However, the fix is not one that is too difficult to put in, and it has a pretty well established set of behaviors. As such, if we are estimating these parameters in a single locale (for more than one location, we have further corrections to make), we should probably apply a small sample size correction. In general, this correction is:</p>
<p><span class="math display">\[
\hat{H}_e = \frac{2N}{2N-1}\left[ 1-\sum_{i=1}^\ell p_i^2 \right]
\]</span></p>
<p>The front part is a small sample size correction factor. Its importance in your estimation diminishes as <span class="math inline">\(N \to \infty\)</span> as shown below. Once you get above <span class="math inline">\(N=9\)</span> individuals, there is an inflation of the estimated heterozygosity at a magnitude of less than 5%.</p>
<div class="figure"><span id="fig:biasCorrection"></span>
<img src="LGDA_files/figure-html/biasCorrection-1.png" alt="Magnitude of the correction factor for small sample size estimations as a function of N." width="672" />
<p class="caption">
Figure 2.1: Magnitude of the correction factor for small sample size estimations as a function of N.
</p>
</div>
</div>
<div id="samples-from-several-locales" class="section level3">
<h3><span class="header-section-number">2.6.3</span> Samples from Several Locales</h3>
<p>In addition to problems associated with estimating allele frequencies incorrectly (and requiring a sample size correction), when we estimate data from several locations, we also have a problem associated with the subset of locales relative to the total population size, resulting in a further correction to account of the several biased samples you are taking.</p>
<p><span class="math display">\[
H_S = \frac{\tilde{N}}{\tilde{N}-1}\left[ 1 - \sum_{i=1}^\ell \frac{p_i^2}{K} - \frac{H_O}{2\tilde{N}} \right]
\]</span></p>
<p>where <span class="math inline">\(\tilde{N}\)</span> is the harmonic mean number of genotypes sampled across each of the <span class="math inline">\(K\)</span> strata. Notice here I use the term <span class="math inline">\(H_S\)</span> instead of <span class="math inline">\(H_E\)</span> so that there isn’t any doubt about the differences when we write and talk about these parameters. This formulation (after Nei 1987) corrects for the sampling across separate locations. To indicate that your estimate is being made using subdivided groups of samples, pass the <code>stratum=</code> parameter to <code>genetic_diversity()</code> and set `mode=“Hes”. We can see the magnitude of the correction by looking at a single population and comparing the estimates of <span class="math inline">\(H_S\)</span> for corrected and non-corrected parameters.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="co">################  HERE HERE HERE</span>
pops &lt;-<span class="st"> </span>arapat[ arapat<span class="op">$</span>Population <span class="op">%in%</span><span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;32&quot;</span>,<span class="st">&quot;101&quot;</span>,<span class="st">&quot;102&quot;</span>),]
he &lt;-<span class="st"> </span><span class="kw">genetic_diversity</span>( pops, <span class="dt">mode=</span><span class="st">&quot;He&quot;</span>)
hes &lt;-<span class="st"> </span><span class="kw">genetic_diversity</span>(pops, <span class="dt">stratum=</span><span class="st">&quot;Population&quot;</span>, <span class="dt">mode=</span><span class="st">&quot;Hes&quot;</span>)[<span class="dv">1</span><span class="op">:</span><span class="dv">8</span>,]
df &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">Locus=</span>he[,<span class="dv">1</span>], <span class="dt">He=</span>he[,<span class="dv">2</span>], <span class="dt">Hes=</span>hes[,<span class="dv">2</span>])
df</code></pre>
<pre><code>##   Locus         He        Hes
## 1  LTRS 0.38850309 0.41230882
## 2   WNT 0.03277778 0.01843238
## 3    EN 0.50285714 0.44289781
## 4    EF 0.27119377 0.31900021
## 5   ZMP 0.09500000         NA
## 6   AML 0.53854875 0.68269231
## 7  ATPS 0.25038580 0.27105726
## 8  MP20 0.80670340 0.81562830</code></pre>
<p>They are pretty close (Pearson’s <span class="math inline">\(\rho =\)</span> 0.970), even when there are only 36 individuals in the sample.<a href="#fn2" class="footnote-ref" id="fnref2"><sup>2</sup></a> But they are off and this is a vitally important distinction because if you do not account for these differences you will percolate these errors up through your subsequent analyses (and this is a bad thing).</p>
</div>
<div id="multilocus-diversity" class="section level3">
<h3><span class="header-section-number">2.6.4</span> Multilocus Diversity</h3>
<p>There are several measures of individual locus diversity but few for multilocus diversity. One potential measure for diversity across loci is to based upon the fraction of population that has unique multilocus genotypes. This is defined as:</p>
<p><span class="math display">\[
D_m = \frac{N_{unique}}{N}
\]</span></p>
<p>and can be estimated using the function <code>mulitlocus_diversity()</code>. Looking across the putative species indicated in the data set, we can see that in general, the Cape populations are much less diverse than those individuals samples throughout Baja California.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">multilocus_diversity</span>( arapat[ arapat<span class="op">$</span>Species<span class="op">==</span><span class="st">&quot;Cape&quot;</span>,])</code></pre>
<pre><code>## [1] 0.56</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">multilocus_diversity</span>( arapat[ arapat<span class="op">$</span>Species<span class="op">==</span><span class="st">&quot;Mainland&quot;</span>,] )</code></pre>
<pre><code>## [1] 0.9722222</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">multilocus_diversity</span>( arapat[ arapat<span class="op">$</span>Species<span class="op">==</span><span class="st">&quot;Peninsula&quot;</span>,] )</code></pre>
<pre><code>## [1] 0.9007937</code></pre>
<p>This is a pretty crude measurement but later when we examine models based upon conditional multilocus genetic distances, we need to make sure that the samples are both allelic rich and multilocus diverse and this approach is a nice way to do that.</p>
</div>
<div id="inbreeding" class="section level3">
<h3><span class="header-section-number">2.6.5</span> Inbreeding</h3>
<p>Inbreeding is one of the most common deviations from random mating (and hence Hardy-Weinberg Equilibrium) that we encounter in natural populations. Inbreeding is defined, <em>sensu stricto</em>, as mating between two related individuals. This ranges from complete selfing, where one parent alone produces offspring, to consanguineous mating, where individuals with some degree of relatedness produce offspring. The genetic consequences of inbreeding are entirely in how alleles are arranged into genotypes, not in changing allele frequencies.</p>
<p>The primary consequence of inbreeding is a reduction in the frequency of the heterozygous genotype. Consider the following Punnet square where a heterozygote is producing a selfed offspring.</p>
<table>
<thead>
<tr class="header">
<th align="right"> </th>
<th align="center"><span class="math inline">\(A\)</span></th>
<th align="center"><span class="math inline">\(B\)</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right"><span class="math inline">\(A\)</span></td>
<td align="center"><span class="math inline">\(AA\)</span></td>
<td align="center"><span class="math inline">\(AB\)</span></td>
</tr>
<tr class="even">
<td align="right"><span class="math inline">\(B\)</span></td>
<td align="center"><span class="math inline">\(AB\)</span></td>
<td align="center"><span class="math inline">\(BB\)</span></td>
</tr>
</tbody>
</table>
<p>The offspring in the next generation are only 50% heterozygotes. Each generation of selfing, homozygotes produce homozygotes but only half of the offspring from heterozygotes stay as such. This process increases the relative frequency of homozygous genotypes in the population, though if you look at the offspring, the frequency of alleles do not change—there are as many A alleles as B alleles in the next generation of selfing.</p>
<p>Conceptually, we can define an inbreeding parameter, <span class="math inline">\(F\)</span>, depicting the extent to which genotype frequencies have deviated from HWE due to inbreeding. But to do so, we need to differentiate between homozygote genotypes that have the same alleles because they are inbred (e.g., both alleles can be traced to a single allele in common ancestor) from those that are identical because they just happen to have the same allele (not of common ancestry). For this, we will define terms for these genotypes as:</p>
<p><strong>Autozygous</strong> - Two alleles that are identical within a genotype because they came from the same individual in the previous generation. These alleles are Identical by Descent and will be found in the population at a rate of <span class="math inline">\(pF\)</span>.</p>
<p><strong>Allozygous</strong> - Two alleles that are identical within a genotype but they came from alternate individuals in the parental generation. These alleles have Identity by State and are expected to occur at a frequency of <span class="math inline">\(p^2(1-F)\)</span>.</p>
<p>Together, the expected frequency of the AA genotype, <span class="math inline">\(E[AA] = p^2(1-F) + pF\)</span>.</p>
<p>At the extremes, if there is no inbreeding—all homozygotes are allozygous—the inbreeding statistic, <span class="math inline">\(F=0\)</span> and the expectation reduces to <span class="math inline">\(E[AA] = p^2\)</span>. Conversely, if all offspring are the result of selfing, <span class="math inline">\(F=1\)</span> and <span class="math inline">\(E[AA] = p\)</span>.</p>
<p>Often the parameter <span class="math inline">\(F\)</span> is the subject of our analyses and the item that is to be estimated from genetic data. Give the definition above, <span class="math inline">\(F\)</span> is defined as the proportional loss of heterozygosity and is estimated as:</p>
<p><span class="math display">\[
\begin{aligned}
F &amp;= \frac{H_e - H_o}{H_e} \\ 
  &amp;= 1 - \frac{H_o}{H_e}
\end{aligned}
\]</span></p>
<p>Programatically, we can estiamte the inbreeding statistic, <span class="math inline">\(F\)</span>, using <code>genetic_diversity()</code>. Technically, this statistic is referred to as <span class="math inline">\(F_{IS}\)</span>, the subscripts indicating that the level of inbreeding is in the <strong>I</strong>ndividual relative to the expectations of the <em>S</em>ubpopulation. There are other levels of inbreeding we will estimate below, which is why we need to make this distinction.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">genetic_diversity</span>( data, <span class="dt">mode=</span><span class="st">&quot;Fis&quot;</span>)</code></pre>
<pre><code>##   Locus       Fis
## 1 Locus 0.0143046</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">genetic_diversity</span>( arapat, <span class="dt">mode=</span><span class="st">&quot;Fis&quot;</span>)</code></pre>
<pre><code>##   Locus       Fis
## 1  LTRS 0.5251293
## 2   WNT 0.5735364
## 3    EN 0.5421225
## 4    EF 0.6697396
## 5   ZMP 0.5447106
## 6   AML 0.5531682
## 7  ATPS 0.8812849
## 8  MP20 0.4540160</code></pre>
</div>
</div>
<div id="rarefaction" class="section level2">
<h2><span class="header-section-number">2.7</span> Rarefaction</h2>
<p>The primary reason for looking at diversity is to perform some comparison, which provides some insights into the biological and/or demographic processes influencing your data. Without a basis for comparison, diversity estimates are just numbers. However, deriving an estimate of diversity is a statistical sampling process and as such we must be aware of the consequences our sampling regime has on the interpretation of the data. This is where rarefaction comes in, a technique commonly used in ecology when comparing species richness among groups.</p>
<p>Here is an example of the problem sampling may interject into your analyses. Consider a single locus with four alleles.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(gstudio)
<span class="kw">data</span>(arapat)
f &lt;-<span class="st"> </span><span class="kw">data.frame</span>( <span class="dt">Allele=</span>LETTERS[<span class="dv">1</span><span class="op">:</span><span class="dv">4</span>], <span class="dt">Frequency=</span><span class="fl">0.25</span>)
f</code></pre>
<pre><code>##   Allele Frequency
## 1      A      0.25
## 2      B      0.25
## 3      C      0.25
## 4      D      0.25</code></pre>
<p>Selected as a random sample from an infinite population. The first sample has 5 individuals.</p>
<pre class="sourceCode r"><code class="sourceCode r">pop1 &lt;-<span class="st"> </span><span class="kw">make_population</span>( f,<span class="dt">N=</span><span class="dv">5</span>)
ae1 &lt;-<span class="st"> </span><span class="kw">genetic_diversity</span>( pop1, <span class="dt">mode=</span><span class="st">&quot;Ae&quot;</span> )
ae1</code></pre>
<pre><code>##   Locus       Ae
## 1 Locus 3.846154</code></pre>
<p>And the second one has 100 individuals.</p>
<pre class="sourceCode r"><code class="sourceCode r">pop2 &lt;-<span class="st"> </span><span class="kw">make_population</span>( f, <span class="dt">N=</span><span class="dv">100</span> )
ae2 &lt;-<span class="st"> </span><span class="kw">genetic_diversity</span>( pop2 )
ae2</code></pre>
<pre><code>##   Locus       Ae
## 1 Locus 3.997601</code></pre>
<p>The difference in estimated diversity among these groups are <code>abs( ae1 - ae2 ) = 0.15</code>. Is this statistically different or are they the same? Is it just because we sampled more individuals in the second set that we get higher values of <span class="math inline">\(A_e\)</span>? Consider the <code>MP20</code> locus in the beetle data set, it has a total of 19 alleles present. If we subsample this data and estimate the number of observed alleles, we see that there is an asymptotic relationship between sampling effort and estimates of allelic diversity. Here is the code for estimating frequency independent diversity, <span class="math inline">\(A\)</span>, using these data.</p>
<pre class="sourceCode r"><code class="sourceCode r">loci &lt;-<span class="st"> </span>arapat<span class="op">$</span>MP20
sz &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">2</span>,<span class="dv">5</span>,<span class="dv">10</span>,<span class="dv">15</span>,<span class="dv">20</span>,<span class="dv">50</span>,<span class="dv">100</span>)
sample_sizes &lt;-<span class="st"> </span><span class="kw">rep</span>( sz, <span class="dt">each=</span><span class="dv">20</span> )
Ae &lt;-<span class="st"> </span><span class="kw">rep</span>(<span class="ot">NA</span>,<span class="kw">length</span>(sample_sizes))
<span class="cf">for</span>( i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw">length</span>(Ae)){
  loci &lt;-<span class="st"> </span><span class="kw">sample</span>( loci, <span class="dt">size=</span><span class="kw">length</span>(loci), <span class="dt">replace=</span><span class="ot">FALSE</span>)
  Ae[i] &lt;-<span class="st"> </span><span class="kw">genetic_diversity</span>( loci[<span class="dv">1</span><span class="op">:</span>sample_sizes[i]], <span class="dt">mode=</span><span class="st">&quot;Ae&quot;</span> )<span class="op">$</span>Ae
}</code></pre>
<p><img src="LGDA_files/figure-html/unnamed-chunk-133-1.png" width="672" /></p>
<p>The ‘curvy’ nature of this relationship shows a few things.</p>
<p>It takes a moderate sample size to capture the main set of alleles in the data set. If we are looking at allocating sampling using only 5 individuals per locale, then we are not going to get the majority of the alleles present.</p>
<p>For the rare alleles, you really need to grab large at-site samples if estimates of diversity are the main component of what you are doing. Do rare alleles aid in uncovering the biological processes you are interested in studying? They may or may not.</p>
<p>For most purposes, we will use all the samples we have collected. In many cases though, some locales may not have as many samples as other ones. So, even with these data, if I have one locale with 10 samples and another with 50, how can I determine if the differences observed are due to true differences in the underlying diversity and which are from my sampling? Just as in testing for HWE, we can use our new friend permutation to address the differences.</p>
<p>Rarefaction is the process of subsampling a larger dataset in smaller chunks such that we can estimate diversity among groups using the same number of individuals. Here is an example in the beetle dataset where I am going to look at differences in diversity among samples (<span class="math inline">\(N = 75\)</span>) collected in the cape regions of Baja California</p>
<pre class="sourceCode r"><code class="sourceCode r">ae.cape &lt;-<span class="st"> </span><span class="kw">genetic_diversity</span>( arapat[ arapat<span class="op">$</span>Species<span class="op">==</span><span class="st">&quot;Cape&quot;</span>, <span class="st">&quot;WNT&quot;</span>] )
ae.cape</code></pre>
<pre><code>##   Locus       Ae
## 1 Locus 1.305052</code></pre>
<p>and compare those to the genetic diversity observed from a smaller collection of individuals sampled from mainland Mexico (<span class="math inline">\(N=36\)</span>).</p>
<pre class="sourceCode r"><code class="sourceCode r">ae.mainland &lt;-<span class="st"> </span><span class="kw">genetic_diversity</span>( arapat[ arapat<span class="op">$</span>Species<span class="op">==</span><span class="st">&quot;Mainland&quot;</span>, <span class="st">&quot;WNT&quot;</span>] )<span class="op">$</span>Ae
ae.mainland</code></pre>
<pre><code>## [1] 1.033889</code></pre>
<p>The observed difference in effective allelic diversity, <span class="math inline">\(A_{e,mainland} == A_{e,cape}\)</span>, could be because the Cape region of Baja California is more diverse or it could be because there are twice as many individuals in that sample.</p>
<p>To perform a rarefaction on these data, we do the following:</p>
<ol style="list-style-type: decimal">
<li>Use the size of the smallest population (<span class="math inline">\(N\)</span>) as the sample size for all estimates.
Randomly sample individuals, without replacement, from the larger dataset in allocations of size <span class="math inline">\(N\)</span>.<br />
</li>
<li>Estimate diversity parameters on these subsamples and repeat to create a ‘null distribution’ of estimated diversity values.<br />
</li>
<li>Compare your observed value in the smallest population to that distribution created by subsampling the larger population.</li>
</ol>
<p>From the data set, this is done by</p>
<pre class="sourceCode r"><code class="sourceCode r">cape.pop &lt;-<span class="st"> </span>arapat[ arapat<span class="op">$</span>Species<span class="op">==</span><span class="st">&quot;Cape&quot;</span>,<span class="st">&quot;WNT&quot;</span>]
null.ae &lt;-<span class="st"> </span><span class="kw">rarefaction</span>( cape.pop, <span class="dt">mode=</span><span class="st">&quot;Ae&quot;</span>,<span class="dt">size=</span><span class="dv">36</span>)
<span class="kw">mean</span>(null.ae)</code></pre>
<pre><code>## [1] 1.305638</code></pre>
<p>So even if the samples sizes are the same, the mean level of diversity remains relatively constant. The range in diversity</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">range</span>(null.ae)</code></pre>
<pre><code>## [1] 1.028163 1.800000</code></pre>
<p>is quite large. Since this estimate is frequency based, random samples of alleles change the underlying estimate of Ae during each permutation.</p>
<p>The observed estimate of diversity in the Mainland populations does fall within this range. However, the null hypothesis states that <span class="math inline">\(A_{e,mainland} = A_{e,cape}\)</span> and if this is true, once we standardize sample size, we can take the distribution of permuted Ae values as a statement about what we should see if the null hypothesis were true. As such, we can treat it probabilistically and estimate the probability that <span class="math inline">\(A_e\)</span>, Mainland is drawn from this distribution.</p>
<pre class="sourceCode r"><code class="sourceCode r">all.ae &lt;-<span class="st"> </span><span class="kw">c</span>( null.ae, ae.mainland)
P &lt;-<span class="st"> </span><span class="kw">sum</span>(ae.mainland <span class="op">&lt;=</span><span class="st"> </span>null.ae) <span class="op">/</span><span class="st"> </span>( <span class="kw">length</span>(all.ae) )
P</code></pre>
<pre><code>## [1] 0.994</code></pre>
<p>Or graphically, it can be depicted as below.</p>
<p><img src="LGDA_files/figure-html/unnamed-chunk-139-1.png" width="672" /></p>
<div id="mapping-diversity" class="section level3">
<h3><span class="header-section-number">2.7.1</span> Mapping Diversity</h3>
<p>Estimating diversity is great and being able to compare two or more groups for their levels of diversity is even better. But often we are looking for spatial patterns in our data. Both R and gstudio provide easy interfaces for plotting data and later in the text we will see how to integrate raster and vector data into our workflows for more sublime approaches to characterizing population genetic processes. In the mean time, it is amazingly easy to use basic plotting commands to get pretty informative output. In this example, I extract the mean coordinate of each stratum in the arapat dataset and then estimate diversity at the level of these partitions and merge the diversity estimates for the AML locus into the coordinate data.frame.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(gstudio)
<span class="kw">data</span>(arapat)
diversity &lt;-<span class="st"> </span><span class="kw">genetic_diversity</span>(arapat, <span class="dt">stratum=</span><span class="st">&quot;Population&quot;</span>, <span class="dt">mode=</span><span class="st">&quot;Ae&quot;</span>)
coords &lt;-<span class="st"> </span><span class="kw">strata_coordinates</span>(arapat)
coords &lt;-<span class="st"> </span><span class="kw">merge</span>( coords, diversity[ diversity<span class="op">$</span>Locus <span class="op">==</span><span class="st"> &quot;AML&quot;</span>, ] )</code></pre>
<p>Then, I grab a map from the Google server and map my populations with diversity depicted as differences in the size of the points. Note that the <code>ggmap()</code> function provides the base map that is retrieved but when we use <code>geom_point()</code> we need to specify the <code>aes()</code> and the <code>data=</code> part as these data are from the <code>data.frame</code> we made, not from the map we grabbed from Google.</p>
<pre class="sourceCode r"><code class="sourceCode r">map &lt;-<span class="st"> </span><span class="kw">population_map</span>(coords, <span class="dt">map.type=</span><span class="st">&quot;google&quot;</span>)
<span class="kw">ggmap</span>(map) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">geom_point</span>( <span class="kw">aes</span>(<span class="dt">x=</span>Longitude,<span class="dt">y=</span>Latitude,<span class="dt">size=</span>Ae), <span class="dt">data=</span>coords)</code></pre>
<p><img src="LGDA_files/figure-html/unnamed-chunk-141-1.png" width="672" /></p>
<p>If you do not have a Google API key for the maps, you may want to make the map using either <code>osm</code> or <code>stamen</code> maps. To do that with the data above, you would ask for it using <code>population_map()</code> as:</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">population_map</span>( coords, <span class="dt">map.source=</span><span class="st">&quot;stamen&quot;</span>, <span class="dt">zoom=</span><span class="dv">6</span>) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">ggmap</span>(map) <span class="op">+</span><span class="st"> </span>
<span class="st">    </span><span class="kw">geom_point</span>( <span class="kw">aes</span>(<span class="dt">x=</span>Longitude,<span class="dt">y=</span>Latitude,<span class="dt">size=</span>Ae), <span class="dt">data=</span>coords)</code></pre>
<p><img src="LGDA_files/figure-html/unnamed-chunk-142-1.png" width="672" /></p>
<p>Notice here that one of the plots is not contained (the warning) as the tile is too small. If you set <code>zoom=6</code> you’ll get all the points in the plot but may be too zoomed out. This is the game we play with tile map servers…</p>
</div>
</div>
<div id="genetic-distance" class="section level2">
<h2><span class="header-section-number">2.8</span> Genetic Distance</h2>
<p>One can measure the relative distance between items based upon some basic assumptions. In Euclidean geometry, the underlying distance measures are based upon the triangle inequality. The same kinds of approaches are available in characterizing genetic separation, either among individuals or among locales. This chapter introduces some of the methodologies used in estimating genetic distances, how we analyze them, and how we portray our results in a graphical fashion amenable for interpretation.</p>
<p>Underlying most estimates of genetic distance are sets of geometric and/or evolutionary assumptions. There are many different metrics that could be estimated from our genetic data, many of which will tell us the same general story. However, there are specific features of our data that may make one kind of metric more appropriate than another type.</p>
<p>There are two main characteristics that control our ability to map collections of genotypes onto a real number line; Self identity and Symmetry. Self identity implies that the distance, <span class="math inline">\(\delta\)</span>, between an object (a single genotype or a collection of genotypes in a population) and itself must be zero: <span class="math inline">\(\delta_{ii}=0\)</span>. You are absolutely identical to yourself. Symmetry implies that the distance between objects is independent of the order in which we measure it; <span class="math inline">\(\delta_{ij} = \delta_{ji}\)</span>. This can be a more problematic assumption in some cases and when we examine estimation of ecological distances later, we will see this may not be the case.</p>
<p>If these two conditions are satisfied, the distance may be considered <em>metric</em> if (and only if) it satisfies the triangle inequality, <span class="math inline">\(\delta_{ij} \le \delta_{ik} + \delta_{kj}\)</span>. We’ve seen this relationship in Euclidean Geometry, the squared length of the hypotenuse is equal to the sum of the squared length of both legs in a triangle; <span class="math inline">\(z^2 = x^2 + y^2\)</span>.</p>
<p>Genetic distance itself is not the final product that allows us to gain inferences about underlying population genetic processes. Rather, it is the input into subsequent analyses. This section focuses first on how we estimate distances, depending upon the level of interest, and then highlights some approaches for visualizing and gaining inferences from the distance matrix itself. In later chapters, we return to the use of distance matrices when we examine network models and analyses based upon the idea of isolation models commonly used in modern population genetic analyses.</p>
<div id="individual-genetic-distance" class="section level3">
<h3><span class="header-section-number">2.8.1</span> Individual Genetic Distance</h3>
<p>Genetic distance can be estimated based upon differences at many levels, the most basal of which is among individuals. In the discussion of the individual genetic distances, the following genotypes will be used for illustrative purposes.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(gstudio)
AA &lt;-<span class="st"> </span><span class="kw">locus</span>(<span class="kw">c</span>(<span class="st">&quot;A&quot;</span>, <span class="st">&quot;A&quot;</span>))
AB &lt;-<span class="st"> </span><span class="kw">locus</span>(<span class="kw">c</span>(<span class="st">&quot;A&quot;</span>, <span class="st">&quot;B&quot;</span>))
BB &lt;-<span class="st"> </span><span class="kw">locus</span>(<span class="kw">c</span>(<span class="st">&quot;B&quot;</span>, <span class="st">&quot;B&quot;</span>))
BC &lt;-<span class="st"> </span><span class="kw">locus</span>(<span class="kw">c</span>(<span class="st">&quot;B&quot;</span>, <span class="st">&quot;C&quot;</span>))
AC &lt;-<span class="st"> </span><span class="kw">locus</span>(<span class="kw">c</span>(<span class="st">&quot;A&quot;</span>, <span class="st">&quot;C&quot;</span>))
CC &lt;-<span class="st"> </span><span class="kw">locus</span>(<span class="kw">c</span>(<span class="st">&quot;C&quot;</span>, <span class="st">&quot;C&quot;</span>))
Locus &lt;-<span class="st"> </span><span class="kw">c</span>(AA, AB, AC, BB, BC, CC)
Locus</code></pre>
<pre><code>## [1] &quot;A:A&quot; &quot;A:B&quot; &quot;A:C&quot; &quot;B:B&quot; &quot;B:C&quot; &quot;C:C&quot;</code></pre>
<div id="euclidean-distance" class="section level4">
<h4><span class="header-section-number">2.8.1.1</span> Euclidean Distance</h4>
<p>The most basic distance metric we can use would be Euclidean. Intuitively, we have a good idea about how this metric works as we use it every day. Euclidean distance is estimated as:</p>
<p><span class="math display">\[
\delta_{eucl} = \sqrt{\sum_{i=1}^\ell (p_{xi}-p_{yi})^2}
\]</span></p>
<p>where <span class="math inline">\(p_{x•}\)</span> is a vector of allele frequencies measured on the <span class="math inline">\(x^{th}\)</span> individual. We can create these by translating the raw genotypes into multivariate data as we in the previous section on individual and population assignment.</p>
<pre class="sourceCode r"><code class="sourceCode r">mv.genos &lt;-<span class="st"> </span><span class="kw">to_mv</span>(Locus)
mv.genos</code></pre>
<pre><code>##        A   B   C
## [1,] 1.0 0.0 0.0
## [2,] 0.5 0.5 0.0
## [3,] 0.5 0.0 0.5
## [4,] 0.0 1.0 0.0
## [5,] 0.0 0.5 0.5
## [6,] 0.0 0.0 1.0</code></pre>
<p>and then using the <code>dist()</code> function that R has built-in to estimate <span class="math inline">\(\delta_{eucl}\)</span></p>
<pre class="sourceCode r"><code class="sourceCode r">D.euc &lt;-<span class="st"> </span><span class="kw">dist</span>( mv.genos )
D.euc</code></pre>
<pre><code>##           1         2         3         4         5
## 2 0.7071068                                        
## 3 0.7071068 0.7071068                              
## 4 1.4142136 0.7071068 1.2247449                    
## 5 1.2247449 0.7071068 0.7071068 0.7071068          
## 6 1.4142136 1.2247449 0.7071068 1.4142136 0.7071068</code></pre>
<p>The output variable, <code>D.euc</code>, is of type</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">class</span>(D.euc)</code></pre>
<pre><code>## [1] &quot;dist&quot;</code></pre>
<p>which is definitely not a matrix object. It is a specific data type that is used for dealing with distance matrices. There are some analyses (variants of AMOVA and the Mantel test come to mind) that require the input matrix to be of type dist rather than of type matrix and don’t do the conversion for you directly.</p>
<p>Because most distance matrices have a zero diagonal (<span class="math inline">\(1^{st}\)</span> requirement outlined previously) and symmetry (the upper diagonal is equal to the lower diagonal, the <span class="math inline">\(2^{nd}\)</span> requirement), it is possible to save computer memory by only dealing with the data below the diagonal. Some analyses, such as an implementation of the Mantel test, require the use of dist objects instead of matrices.</p>
<p>It is easy to convert between the two object types as necessary.</p>
<pre class="sourceCode r"><code class="sourceCode r">D.euc &lt;-<span class="st"> </span><span class="kw">as.matrix</span>( D.euc )
D.euc</code></pre>
<pre><code>##           1         2         3         4         5         6
## 1 0.0000000 0.7071068 0.7071068 1.4142136 1.2247449 1.4142136
## 2 0.7071068 0.0000000 0.7071068 0.7071068 0.7071068 1.2247449
## 3 0.7071068 0.7071068 0.0000000 1.2247449 0.7071068 0.7071068
## 4 1.4142136 0.7071068 1.2247449 0.0000000 0.7071068 1.4142136
## 5 1.2247449 0.7071068 0.7071068 0.7071068 0.0000000 0.7071068
## 6 1.4142136 1.2247449 0.7071068 1.4142136 0.7071068 0.0000000</code></pre>
<p>if you need to perform operations that are not available to dist objects (like matrix algebra).</p>
</div>
<div id="amova-distance" class="section level4">
<h4><span class="header-section-number">2.8.1.2</span> AMOVA Distance</h4>
<p>Another geometric interpretation of inter-individual distance is that of Excoffier <em>et al.</em> (2004), dubbed AMOVA distance. Smouse &amp; Peakall (1999) provided the geometry of this relationship for diploid loci when discussing spatial autocorrelation. AMOVA distance can be visualized as the distance between vertices and mid-points on an equilateral triangle. Each segment is defined as having unit length and the distance is taken as the square of the distance between genotypes.</p>
<p><img src="media/AMOVA_Distance.png" width="200" /></p>
<p>In R, we calculate it as:</p>
<pre class="sourceCode r"><code class="sourceCode r">D.amova &lt;-<span class="st"> </span><span class="kw">genetic_distance</span>( Locus, <span class="dt">mode=</span><span class="st">&quot;AMOVA&quot;</span> )
<span class="kw">rownames</span>(D.amova) &lt;-<span class="st"> </span><span class="kw">colnames</span>(D.amova) &lt;-<span class="st"> </span><span class="kw">as.character</span>( Locus )
D.amova</code></pre>
<pre><code>##     A:A A:B A:C B:B B:C C:C
## A:A   0   1   1   4   3   4
## A:B   1   0   1   1   1   3
## A:C   1   1   0   3   1   1
## B:B   4   1   3   0   1   4
## B:C   3   1   1   1   0   1
## C:C   4   3   1   4   1   0</code></pre>
<p>For completeness, the previous figure should be drawn as a tetrahedron with the possibility of four alleles at a locus (allowing for distances between two heterozygotes that do not share any alleles). However, that is not an easy thing to draw for me… The only interesting distance you’ll need to think about (and perhaps grab a piece of paper and draw some triangles) is the distance between two two heterozygotes that share no alleles. I’ll leave it up to you to figure out that one (or use <code>genetic_distance()</code> for it).</p>
</div>
<div id="bray-curtis-individual-distance" class="section level4">
<h4><span class="header-section-number">2.8.1.3</span> Bray-Curtis Individual Distance</h4>
<p>A distance metric that can be used to test differences among individuals or populations is that of Bray-Curtis. This distance is a transformation of Jaccard’s distance (see below) and is derived from an ecological ordination paper by Bray &amp; Curtis (1957).</p>
<p><span class="math display">\[
D_C = 1 - 2\frac{\sum_{i=1}^\ell min(p_{X,i},p_{Y,i})}{\sum_{i=1}^\ell p_{X,i} + \sum_{i=1}^\ell p_{Y,i}}
\]</span></p>
<p>This parameter is bound by 0 on the lower end, indicating that the two items being compared are identical and 1 at the upper end indicating complete dissimilarity. In R, this distance is defined in the vegan package for normal vegetation analysis and in gstudio for genetic data. There is some confusion in the literature as to how this distance metric should be calculated and it is implied by Yoshioka (2008) that at least some of the implementations are actually Czekanowski distance. At the time of this writing, there are some discrepancies between the distances that are calculated in different programs, whose names will be withdrawn to protect the innocent, so be aware. In the end, it is not fealty to a particular distance metric that is important in our analyses, it is the ability of some metric to describe the variation we see.</p>
<p>The implementation in gstudio uses allele counts across all loci.</p>
</div>
<div id="ladder-distance" class="section level4">
<h4><span class="header-section-number">2.8.1.4</span> Ladder Distance</h4>
<p>For microsatellite loci, which have a specific step-wise mutation model, a genetic distance metric can be created based upon the number of repeat motif differences at genotypes rather than just binary same/different alleles (as in the AMOVA distance before). If the stepwise mutation process at microsatellite loci has played a significant role in shaping the structure on the landscape then we expect the kinds of spatial signal that is present in a ladder distance approach should differ from an approach that does not take into consideration the unique characteristics of this kind of locus. If they say provide very similar kinds of inferences then it is more likely that mutation, as a process, has not shaped the history to a large extent.</p>
</div>
</div>
<div id="population-level-genetic-distances" class="section level3">
<h3><span class="header-section-number">2.8.2</span> Population-Level Genetic Distances</h3>
<p>If we are collecting data in such a way as to have pre-defined (or determined ex post facto) groups (populations or locales), several additional distance metrics can be derived. Below are a few of the more common ones that you will run into. It should be said that there is no dearth of genetic distance metrics available.</p>
<div id="czekanowski-manhattan-distance" class="section level4">
<h4><span class="header-section-number">2.8.2.1</span> Czekanowski (Manhattan) Distance</h4>
<p>Perhaps the simplest distance metric is that of Czekanowski—more commonly referred to as Manhattan distance. It is called Manhattan distance because it is a distance metric that is analagous to how you measure city-block distances. It is relatively difficult in a city to walk from one place to another in a straight line, rather we are forced to walk down this street, turn walk down that one, etc.</p>
<p><img src="media/Chezkanowski_Distance.png" width="214" /></p>
<p>Population allele frequencies can be plot on the linear axis <span class="math inline">\(\sum_{i=1}^\ell p_i = 1\)</span> and the distance between populations is the sum of the lengths separating each population on each of the <span class="math inline">\(\ell\)</span> axis. This is calculated as:</p>
<p><span class="math display">\[
D_{Cz} = \frac{1}{2}\left| p_{i,x} - p_{i,y} \right|
\]</span></p>
<p>where the pipes, <span class="math inline">\(|x|\)</span>, indicate taking the absolute value.</p>
</div>
<div id="rogers-euclidean-distance" class="section level4">
<h4><span class="header-section-number">2.8.2.2</span> Rogers (Euclidean) Distance</h4>
<p>Stepping up, slightly, in complexity, we get to Roger’s distance. This distance metric is roughly equivalent to Euclidean distance (and indeed in gstudio it is called euclidean).</p>
<p><img src="media/Rodgers_Distance.png" width="200" /></p>
<p>Here we consider the allele frequencies as before but instead of taking the absolute values of the distances along each axis, we take the straight-line distance. This is estimated as:</p>
<p><span class="math display">\[
D_R = \sqrt{ \frac{1}{2} \sum_{i=1}^\ell\left( p_{i,x} - p_{i,y}\right)^2 }
\]</span></p>
<p>This is a more common distance metric than that of Czkanowski and has been used in classification and taxonomy. There are a few drawbacks to this distance metric that stem from not being based upon population genetic theory. These may, or may not, be relevant to what you are doing with your data and where your data is from.</p>
<ol style="list-style-type: decimal">
<li>This distance is not proportional to time of separation of populations. There is no drift component to it.<br />
</li>
<li>This distance is not proportional to the number of base-pair substitutions, which may be important if you are looking at haplotype divergence.<br />
</li>
<li>This distance may loose sensitivity with increased allelic diversity.</li>
</ol>
<p>If you are using this metric at short time intervals, have loci of moderately diversity, or are not concerned about homology, this is a quick metric.</p>
</div>
<div id="neis-genetic-distance" class="section level4">
<h4><span class="header-section-number">2.8.2.3</span> Nei’s Genetic Distance</h4>
<p>One of the most common distance metrics used is that of Nei, and is estimated as:</p>
<p><span class="math display">\[
I = \frac{\sum_{i=1}^L\sum_{j=1}^{\ell_{i}} p_{ij,x}p_{ij,y}}{\sqrt{\sum_{i=1}^L\left(\sum_{j=1}^{\ell_i} p_{ij,x}^2\right)\sum_{i=1}^L\left(\sum_{j=1}^{\ell_i} p_{ij,y}^2\right)}} 
\]</span></p>
<p>but more commonly referred to using the transform:</p>
<p><span class="math display">\[
D_{Nei} = -\ln(I)
\]</span></p>
<p>This metric is roughly linear in time, assuming a drift-mutation equilibrium. Populations with longer periods of separation will have larger values of <span class="math inline">\(D_{Nei}\)</span>. If you think that drift and mutation are significant features that have shaped the divergence of your populations, then this is an appropriate metric to use.</p>
</div>
<div id="conditional-genetic-distance" class="section level4">
<h4><span class="header-section-number">2.8.2.4</span> Conditional Genetic Distance</h4>
<p>There is a final genetic distance that should be discussed here, Conditional Genetic Distance, derived from a network abstraction of genetic covariance by Dyer &amp; Nason (2004). However, both the rationale and the approach that produce these measures of distance rely on some approaches that need further development and will be put off until a more complete treatment can be done in the chapter on population graphs.</p>
</div>
</div>
</div>
<div id="genetic-structure" class="section level2">
<h2><span class="header-section-number">2.9</span> Genetic Structure</h2>
<p>The term ‘structure’ is used in many different ways in population genetics. Essentially, data has genetic structure if there is a non-random association of genotypes across your sampling locations. The interaction of population genetic processes create the genetic structure we see, though it is not easy to infer historical process from the presence of structure alone. For this we need to rely upon more cleaver experimental design. In this chapter we examine parameters designed to describe the amount of structure present in a dataset and how we can derive some level of inference from their magnitudes.</p>
<p>Structure in populations influences the distribution (spatial, ecological, and temporal) distribution of of alleles. Until this point, we have focused on how alleles coalesce into genotypes at the individual level, local allele frequencies and the Hardy Weinberg expansion provide an expectation for the probability of seeing a heterozygote, for example. As we scale up from the individual itself to the deme (or sub-population) in which it resides, we can also estimate heterozygosity. As we coalesce these demes into populations, regions, continents, etc. we can also estimate expectations for heterozygosity at these levels as well. The deviance from these expectations at all levels can be captured in a statistic—the <span class="math inline">\(F\)</span>-statistic we’ve seen already is on of them—useful for comparisons among studies, sites, etc. The <span class="math inline">\(F\)</span>-statistics are perhaps the most misused parameters in population genetics but they have both a long history of use and pretty robust expectations with respect to how they will respond to various evolutionary processes.</p>
<p>In this section, we will explore genetic structure, <em>sensu lato</em>, providing examples of single and multilocus statistics and how we currently think they should be used.</p>
</div>
<div id="f-statistics-and-thier-ilk" class="section level2">
<h2><span class="header-section-number">2.10</span> F-Statistics and Thier Ilk</h2>
<p>The most commonly used parameter for in population genetics are derived from Wright’s <span class="math inline">\(F\)</span>-Statistics. We have already encountered one of them, the inbreeding parameter F, which we calculated using the <code>genetic_diversity()</code> function using <code>mode=&quot;Fis&quot;</code>. This parameter compares the level of observed heterozygosity to that expected under HWE as:</p>
<p><span class="math display">\[
F_{IS} = 1 - \frac{H_O}{H_E}
\]</span></p>
<p>If the locale in question is producing heterozygotes at a rate consistent with HWE then there is no ‘inbreeding’ (as we defined it previously). This being said, the expected frequency of heterozygotes can be estimated at several different demographic levels if you have data that is subdivided. Assuming you have individuals, sampled from K different locales, you can estimate heterozygosity at the following levels:</p>
<ul>
<li>Individual heterozygosity (<span class="math inline">\(H_I\)</span>): This is what we’ve been calling HO, observed heterozygosity and is estimated as the fraction of heterozygotes in your sample for a particular locale, <span class="math inline">\(H_I = \frac{N_{ij}}{N}\)</span>. This value can be interpreted as the “average heterozygosity of all genes in an individual” or as “the probability of observing a heterozygote at a particular locus.”<br />
</li>
<li>Subpopulation heterozygosity (<span class="math inline">\(H_S\)</span>): This is the rate of heterozygosity expected at a particular sampling sub-population (or what I refer to in this text as a locale). This is estimated as the average in expected heterozygosity (<span class="math inline">\(H_E\)</span>) across all <span class="math inline">\(K\)</span> sampling locales; <span class="math inline">\(H_S = \frac{1}{K}\sum_{i=1}^K 2p_iq_i\)</span>. It assumes that each of your sampling locales is in HWE, each conforming to the host of assumptions necessary to satisfy that condition.<br />
</li>
<li>Total heterozygosity (<span class="math inline">\(H_T\)</span>): This is the total heterozygosity across all the data. This is the expected heterozygosity if all the data were merged and mating as a single panmictic population. This parameter is estimated as <span class="math inline">\(H_T = 2\bar{p}\bar{q}\)</span>, where the frequencies for each allele are determined as the average across all sampling locales.</li>
</ul>
<p>If the underlying mating patterns among subdivided populations restrict <em>gene flow</em>, then these estimates of heterozygosity will change. At one extreme, if all populations are mixing freely and it is essentially a single panmictic population then heterozygosity at the sub-population and total population levels will be equal, <span class="math inline">\(H_T=H_S\)</span>, independent of the amount of inbreeding (or consanguineous mating that is actually occurring). At the other extreme, if all locales are genetically isolated from each other, then each will be diverging its own evolutionary trajectory both sub-population and total estimates of heterozygosity will diverge. In fact, it is exactly these relationships between estimates of heterozygosity that Sewell Wright used to derive the oft-misused <span class="math inline">\(F\)</span>-Statistics.</p>
<p>To date, we’ve already used one of these parameters, when examining inbreeding. Our <span class="math inline">\(F\)</span>-statistic is the first demographic level. Using this new terminology for heterozygosity, the inbreeding statistic is defined as:</p>
<p>\begin{aligned}
F_{IS} &amp;=  \
&amp; = 1 - 
\end{aligned}</p>
<p>where the subscripts on the parameters reveal the sampling level being used. In this case, the subscripts on <span class="math inline">\(F_{IS}\)</span> stand for “inbreeding of _I_ndividuals relative to the _S_ubpopulation they are sampled.&quot; The values of this parameter are positive when we see less heterozygotes than expected, and can be negative when we see more heterozygotes than expected under HWE. This parameter makes particular sense in light of unknown subdivision in populations, the Wahlund Effect discussed earlier.</p>
<p>At the next level, we can examine inbreeding of the Subpopulation relative to the Total data set, <span class="math inline">\(F_{ST}\)</span>. This is defined as:</p>
<p>\begin{aligned}
F_{ST} &amp;=  \
&amp;= 1 - 
\end{aligned}</p>
<p>This parameter has been so misused in the literature, it is almost a caricature of itself. As we see from the formula, it is the reduction in heterozygosity of the subpopulation relative to the entire data set. This parameter can be either positive or negative. Wright’s original formulation of the parameter <span class="math inline">\(F_{ST}\)</span> was as:</p>
<p>\begin{aligned}
F_{ST} &amp; =  \
&amp; = 1 - 
\end{aligned}</p>
<p>Where <span class="math inline">\(\sum_{i=1}^\ell \sigma_{q_{S(i)}}^2\)</span> is the variance in allele frequencies across subpopulations (the <span class="math inline">\(S(i)\)</span> subscript) using all <span class="math inline">\(\ell\)</span> alleles at the locus, and <span class="math inline">\(q_{T(i)}\)</span> is the average allele frequency across all subpopulations. The parameters <span class="math inline">\(y_{ST}\)</span> and <span class="math inline">\(y_T\)</span> are equivalent to <span class="math inline">\(H_S\)</span> (average expected heterozygosity across subpopulations) and <span class="math inline">\(H_T\)</span> (expected heterozygosity of average allele frequencies) respectively.</p>
<p>Lets take a simple example and work though this for clarity as the estimators <span class="math inline">\(H_S\)</span> and <span class="math inline">\(H_T\)</span> can be a bit confusing at times. Consider the case where we have three populations assayed for a single bi-allelic locus. Allele frequencies at each of the populations are:</p>
<pre class="sourceCode r"><code class="sourceCode r">p &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="fl">0.2</span>, <span class="fl">0.3</span>, <span class="fl">0.4</span>)
q &lt;-<span class="st"> </span><span class="dv">1</span><span class="op">-</span>p</code></pre>
<p>which give an expected heterozygosity of:</p>
<pre class="sourceCode r"><code class="sourceCode r">hs &lt;-<span class="st"> </span><span class="dv">2</span><span class="op">*</span>p<span class="op">*</span>q
hs</code></pre>
<pre><code>## [1] 0.32 0.42 0.48</code></pre>
<p>Whose average is:</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">mean</span>(hs)</code></pre>
<pre><code>## [1] 0.4066667</code></pre>
<p>For <span class="math inline">\(H_T\)</span>, we estimate the average of the allele frequencies (<span class="math inline">\(\bar{p}\)</span> and <span class="math inline">\(\bar{q}\)</span>) and then the expectation for heterozygosity (<span class="math inline">\(2\bar{p}\bar{q}\)</span>) as:</p>
<pre class="sourceCode r"><code class="sourceCode r">pbar &lt;-<span class="st"> </span><span class="kw">mean</span>(p)
qbar &lt;-<span class="st"> </span><span class="kw">mean</span>(q)
ht &lt;-<span class="st"> </span><span class="dv">2</span><span class="op">*</span>pbar<span class="op">*</span>qbar
ht</code></pre>
<pre><code>## [1] 0.42</code></pre>
<p>From these values, we can estimate <span class="math inline">\(F_{ST}\)</span> as:</p>
<p>\begin{aligned}
F_{ST} &amp; = 1 -  \
&amp;= 1 -  \
&amp; 0.317
\end{aligned}</p>
<p>Values of <span class="math inline">\(F_{ST}\)</span> that are close to zero indicate low levels of differentiation, whereas those close to unity represent complete differentiation (with very important caveats that follow).</p>
<div id="issues-with-fixation-indices" class="section level3">
<h3><span class="header-section-number">2.10.1</span> Issues with Fixation Indices</h3>
<p>One could interpret the original configuration of <span class="math inline">\(F_{ST}\)</span> as being a ratio of variances. The numerator is the variance in allele frequencies across sampled locations and the denominator is essentially the variance of binomial (or multinomial if <span class="math inline">\(\ell &gt; 2\)</span>).</p>
<p>The largest issues with this parameter is that it is NOT a measure of genetic differentiation in the sense that it tells us how different populations are (e.g., how we would use this term in the common vernacular). In fact, Sewell Wright (1984) specifically states that</p>
<p><span class="math inline">\(F_{ST}\)</span> can be interpreted as a measure of the amount of differentiation among subpopulations, relative to the limiting amount under complete fixation…</p>
<p>This can be seen in the following examples and the values we get for the parameter <span class="math inline">\(F_{ST}\)</span> in each.</p>
<p><em>Scenario 1:</em> Two populations, <code>A</code> and <code>B</code>, each fixed for a different allele. In this case, the heterozygosity at population <code>A</code> would be <span class="math inline">\(2p_Aq_A = 2*0*1 = 0\)</span>, likewise for population <code>B</code> at <span class="math inline">\(2p_Bq_B = 2*1*0 = 0\)</span>, and the estimate of subpopulation heterozygosity is <span class="math inline">\(H_S = \frac{0+0}{2} = 0\)</span>. Total heterozygosity, <span class="math inline">\(H_T\)</span>, is defined using allele frequencies averaged across populations and would be <span class="math inline">\(H_T = 2\bar{p}\bar{q} = 2*0.5*0.5 = 0.5\)</span> making <span class="math inline">\(F_{ST} = 1 - \frac{0}{0.5} = 1.0\)</span>. These two populations are diverged completely from each other and this makes sense. Subpopulation heterozygosity, <span class="math inline">\(H_S\)</span>, is <em>always</em> zero when any number of populations are fixed for a single allele.</p>
<p><em>Scenario 2:</em> Two populations with two alleles each, though not the same alleles. In the most simple case lest assume population <code>A</code> is in HWE with alleles <code>A</code> and <code>B</code> occurring at equal frequencies and the other population has alleles <code>C</code> and <code>D</code> also at equal frequencies. In this case, heterozygosity at each population would be <span class="math inline">\(H_{S,A} = H_{S,B} = 0.5\)</span> and <span class="math inline">\(H_S = 0.5\)</span> as it is the average of the expected population-level heterozygosity. The total expected heterozygosity is the heterozygosity of allele frequencies averaged across populations, which in this simple example we have <span class="math inline">\(\bar{p}_A = \bar{p}_B = \bar{p}_C = \bar{p}_D\)</span> and <span class="math inline">\(H_T = 1 - \sum_{i=1}^\ell p_i^2 = 0.75\)</span><a href="#fn3" class="footnote-ref" id="fnref3"><sup>3</sup></a> This makes <span class="math inline">\(F_{ST} = \frac{H_T - H_S}{H_T} = \frac{0.75 - 0.25}{0.75} = 0.33\)</span>. Intuitively, this does not make much sense, why would it be a third if <em>both</em> populations are in HWE, just for different alleles?</p>
<p><em>Scenario 3:</em> Three populations, the first of which is fixed for allele <code>A</code> and the rest that are fixed for allele <code>B</code>. In this scenario, <span class="math inline">\(H_S = \frac{1}{3}\left[ 2p_1q_1 + 2p_2q_2 + 2p_3q_3 \right] = 0\)</span> but <span class="math inline">\(H_T\)</span>, being defined as the expected heterozygosity of averaged allele frequencies, <span class="math inline">\(\bar{p} = \frac{1+0+0}{3} = 0.33\)</span> and <span class="math inline">\(\bar{q} = \frac{0+1+1}{3} = 0.66\)</span> would be <span class="math inline">\(H_T = 2\bar{p}\bar{q} = 2*0.33*0.66 = 0.4356\)</span> and <span class="math inline">\(F_{ST} = \frac{0.4356 - 0}{0.4356} = 1\)</span>. Again, when populations are fixed for different alleles, <span class="math inline">\(F_{ST} = 1.0\)</span>. However, in this case, two of our populations are entirely identical! How is it that the two populations with identical allele frequencies (and whose own <span class="math inline">\(F_{ST} = 0\)</span> by the way) can cause <span class="math inline">\(F_{ST}\)</span> to go to unity? In fact, we could have 100 populations fixed for one allele and 1 population fixed for the other and still have <span class="math inline">\(F_{ST} = 1.0\)</span>!</p>
<p>This is because, as Wright (1984, pg 82) pointed out:</p>
<blockquote>
<blockquote>
<p>The fixation index is thus not a measure of degree of differentiation in the sense implied by the extreme case by absence of any common allele. It measures differentiation within the total array in the sense of the extent to which the process of fixation has gone towards completion.</p>
</blockquote>
</blockquote>
<p>This is not how it is used in the literature, where it is often used to describe the differences among populations in an absolute sense. This is why these are called fixation indices (the <span class="math inline">\(F\)</span> is for fixation).</p>
<p>For completeness, we can also estimate the inbreeding of an individual relative to the total population,</p>
<p><span class="math display">\[
F_{IT} = \frac{H_T - H_I}{H_T}
\]</span></p>
<p>though it is not often used because individuals are inbred relative to the populations within which they are found, not within which the entire dataset is composed. Moreover, the three parameters have the following relationship,</p>
<p><span class="math display">\[
(1-F_{IS})(1-F_{ST}) = (1-F_{IT})
\]</span></p>
<p>which means that once <span class="math inline">\(F_{IS}\)</span> and <span class="math inline">\(F_{ST}\)</span> are estimated, <span class="math inline">\(F_{IT}\)</span> is completely defined.</p>
<p>Before we jump into some data, we need to address one more issue that we are confronted with.</p>
<p><em>Scenario 4:</em> Estimation of the population-level heterozygosity is not done without error. In fact, we are estimating these parameters for each of the populations and every time we need to determine estimates of allele frequencies. As such, if we are going to take this into consideration, we need to correct estimates of heterozygosity accordingly.</p>
<p>Here is an example of the differences we will see if we do not account for these problems (as well as the issue of samples sizes and sampling locations discussed in <a href="genetic-data.html#samples-from-several-locales">2.6.3</a>). In the arapat data set, I’m going to use the two of the mainland populations and estimate <span class="math inline">\(F_{ST}\)</span> from them for a single locus as an example to demonstrate this last issue and show the magnitude of the bias that may be introduced by not considering that each of the stratum have estimated heterozygosity with a bit of error.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(gstudio)
<span class="kw">data</span>(arapat)
df &lt;-<span class="st"> </span>arapat[ arapat<span class="op">$</span>Population <span class="op">%in%</span><span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;101&quot;</span>,<span class="st">&quot;102&quot;</span>), <span class="kw">c</span>(<span class="dv">3</span>,<span class="dv">13</span>)]
df &lt;-<span class="st"> </span><span class="kw">droplevels</span>( df )</code></pre>
<p>Here is what that looks like (the <code>droplevels()</code> bit is to remove the non-observed populations from the stratum column in the derived <code>data.frame</code>).</p>
<pre class="sourceCode r"><code class="sourceCode r">df</code></pre>
<pre><code>##     Population  ATPS
## 328        101 02:02
## 329        101 02:02
## 330        101 09:09
## 331        101 02:02
## 332        101 04:04
## 333        101 02:02
## 334        101 02:02
## 335        101 02:09
## 336        101 02:09
## 356        102 02:09
## 357        102 02:02
## 358        102 02:02
## 359        102 02:02
## 360        102 02:02
## 361        102 02:02
## 362        102 02:02
## 363        102 02:02</code></pre>
<p>If you look at the alleles present by locus, you can see quite that the allele frequencies (above) are not that close to each other—in fact, population <code>101</code> has the <code>04</code> allele that is not present in population 102. Numerically, they are:</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">frequencies</span>(df, <span class="dt">stratum =</span> <span class="st">&quot;Population&quot;</span>)</code></pre>
<pre><code>##   Stratum Locus Allele Frequency
## 1     101  ATPS     02 0.6666667
## 2     101  ATPS     04 0.1111111
## 3     101  ATPS     09 0.2222222
## 4     102  ATPS     02 0.9375000
## 5     102  ATPS     09 0.0625000</code></pre>
<p>If we estimate heterozygosity directly for each population we see that the individual, population-level, heterozygosity, is estimated as:</p>
<pre class="sourceCode r"><code class="sourceCode r">x &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="kw">genetic_diversity</span>(df[df<span class="op">$</span>Population<span class="op">==</span><span class="st">&quot;101&quot;</span>,],<span class="dt">mode=</span><span class="st">&quot;He&quot;</span>)<span class="op">$</span>He, <span class="kw">genetic_diversity</span>(df[df<span class="op">$</span>Population<span class="op">==</span><span class="st">&quot;102&quot;</span>,],<span class="dt">mode=</span><span class="st">&quot;He&quot;</span>)<span class="op">$</span>He)
x</code></pre>
<pre><code>## [1] 0.4938272 0.1171875</code></pre>
<p>which results in an estimate of <span class="math inline">\(H_S\)</span>:</p>
<pre class="sourceCode r"><code class="sourceCode r">hs &lt;-<span class="st"> </span><span class="kw">mean</span>(x)
hs</code></pre>
<pre><code>## [1] 0.3055073</code></pre>
<p>Similarly, the parameter <span class="math inline">\(H_T\)</span> is:</p>
<pre class="sourceCode r"><code class="sourceCode r">ht &lt;-<span class="st"> </span><span class="kw">genetic_diversity</span>(df,<span class="dt">mode=</span><span class="st">&quot;He&quot;</span>)<span class="op">$</span>He
ht</code></pre>
<pre><code>## [1] 0.3442907</code></pre>
<p>We can estimate <span class="math inline">\(F_{ST}\)</span> as:</p>
<pre class="sourceCode r"><code class="sourceCode r">Fst_biased &lt;-<span class="st"> </span><span class="dv">1</span> <span class="op">-</span><span class="st"> </span>hs<span class="op">/</span>ht
Fst_biased</code></pre>
<pre><code>## [1] 0.1126471</code></pre>
<p>If we do take into consideration the error associated with estimating these parameters, we find a much smaller value:</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">Fst</span>(df)</code></pre>
<pre><code>##   Locus        Hs        Ht        Fst
## 1  ATPS 0.3347824 0.3479467 0.03783444</code></pre>
<p>Notice here that <span class="math inline">\(H_S\)</span> is estimated from averaging (the first way) 10% lower than done when considering sampling allocations. The bias associated with <span class="math inline">\(H_T\)</span> is much smaller but exists all the same. Overall, the problem here is an overestimation of <span class="math inline">\(F_{ST}\)</span> by a factor of almost 3! These results are exaggerated a bit because of the small size—it would be foolish to estimate <span class="math inline">\(F_{ST}\)</span> from only N=17 individuals from two populations. However, it does show the importance of considering sampling allocations. As you sample more individuals, these estimates of heterozygosity will converge.</p>
</div>
<div id="additional-x_st-like-parameters" class="section level3">
<h3><span class="header-section-number">2.10.2</span> Additional <span class="math inline">\(X_{ST}\)</span>-like Parameters</h3>
<p>The use (and perhaps misuse) of [~] has supported the development of almost a cottage industry in other parameters, each trying to fit into a specific perceived problem in the original parameter. Here are some other extensions of this basic parameter that you may come across:</p>
<ul>
<li><span class="math inline">\(R_{ST}\)</span> for Microsatellite loci. This uses the ladder genetic distance metric discussed previously.<br />
</li>
<li><span class="math inline">\(N_{ST}\)</span> for Nucleotides variation.<br />
</li>
<li><span class="math inline">\(G_{ST}\)</span> for population subdivision (and in some cases mutation).<br />
</li>
<li><span class="math inline">\(G_{ST}^\prime\)</span> for loci with high allelic diversity (along with its nemesis <span class="math inline">\(D_{est}\)</span>).</li>
</ul>
<p>Each of these parameters attempts to solve an additional problem that people have posed for <span class="math inline">\(F_{ST}\)</span>. The magnitude of bias associated with each may be differential, depending upon the extent to which your data are violating underlying assumptions. For example, at highly diverse loci, the expectation for [~] is limited in that it cannot reach its theoretical maximum. As such, Hedrick (ref) has derived the [~] parameter that corrects for this. In general, the degree to which [~] and [~] diverge depend upon both the diversity and the evenness of allele frequencies in your populations. This begs the question, “Is there a cutoff when I should not longer use [~] and prefer [~] instead?” I think Hedrick would suggest to always use it the secondary one, just in case, though it may be in your best interest to examine the differences in the parameters in your own data first.</p>
<p>Here is an example of how these parameters may give alternative estimates. I’ll use the MP20 locus as it is a microsatellite locus of high diversity and compare the [~], [~], and [~] estimates.</p>
<pre class="sourceCode r"><code class="sourceCode r">df &lt;-<span class="st"> </span>arapat[, <span class="kw">c</span>(<span class="dv">3</span>,<span class="dv">14</span>)]
<span class="kw">genetic_structure</span>(df,<span class="dt">stratum=</span><span class="st">&quot;Population&quot;</span>,<span class="dt">mode=</span><span class="st">&quot;Gst&quot;</span>)</code></pre>
<pre><code>##   Locus      Gst        Hs        Ht        P
## 1  MP20 0.308848 0.5663341 0.8194061 0.308848</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">genetic_structure</span>(df,<span class="dt">stratum=</span><span class="st">&quot;Population&quot;</span>,<span class="dt">mode=</span><span class="st">&quot;Gst_prime&quot;</span>)</code></pre>
<pre><code>##   Locus       Gst        Hs        Ht P
## 1  MP20 0.7227937 0.5663341 0.8194061 0</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">genetic_structure</span>(df,<span class="dt">stratum=</span><span class="st">&quot;Population&quot;</span>,<span class="dt">mode=</span><span class="st">&quot;Dest&quot;</span>)</code></pre>
<pre><code>##   Locus      Dest        Hs        Ht         P
## 1  MP20 0.5686012 0.5663341 0.8194061 0.5686012</code></pre>
<p>Is the diversity at this locus influencing structure estimation? Yes, you can clearly see that [~] alone produces a much smaller value than the other parameters. Which of the other ones are more accurate? That is an interpretive question you have to answer knowing your study system.</p>
</div>
</div>
<div id="statistical-structure" class="section level2">
<h2><span class="header-section-number">2.11</span> Statistical Structure</h2>
<p>Thus far, we’ve examined parameters that describe genetic structure, in relation to fixation. These paremeters are all based upon underlying population genetic assumptions. However, that need not be the case. In 1984, Wier &amp; Cockerham derived a parameter <span class="math inline">\(\theta\)</span>, which was an estimator for <span class="math inline">\(F_{ST}\)</span> but based upon an analysis of variance approach rather than expectations relying upon heterozygosity. This statistic is essentially a variance ratio, derived from a random-effects analysis of variance model, just like we would use in normal parametric statistics. Later, Excoffier et al. (1992) expanded upon this approach to provide a multilocus estimate of this parameter, which they called <span class="math inline">\(\Phi_{ST}\)</span> using an analysis they termed AMOVA (for Analysis of MOlecular VAriance). In 2004, Dyer <em>et al.</em> showed how both of these approaches are just special cases of a more general family of Q-mode linear regression models, amenable to broad ranges of sampling designs and configurations.</p>
<p>Taken as a whole, the distance among all N individuals can be represented as a pairwise genetic distance matrix, <span class="math inline">\(\mathbf{D}\)</span>. This matrix has the form:</p>
<p><img src="media/amova_D.png" width="100" style="display: block; margin: auto;" /></p>
<p>which is symmetric ($<em>{ij}^2 = </em>{ji}^2) and has zero squared distance down the diagonal. This can be evaluated as an Analysis of Variance by decomposing the squared distance values into the Total Sums of Squared Distances</p>
<p><span class="math display">\[
SSD_{T} = \frac{\sum_{i=1}^N\sum_{j=1}^N\delta_{ij}^2}{2N-1}
\]</span></p>
<p><img src="media/amova_ssdt.png" width="100" style="display: block; margin: auto;" /></p>
<p>the Sums of Squared Distances Within strata</p>
<p><span class="math display">\[
SSD_{W} = \sum_{k=1}^K \left[ \frac{\sum_{i=1}^{N_k}\sum_{j=1}^{N_k}\delta_{ij}^2}{2N_k-1} \right]
\]</span></p>
<p><img src="media/amova_ssdw.png" width="100" style="display: block; margin: auto;" /></p>
<p>and the Sums of Squared Distances Among populations.</p>
<p><span class="math display">\[
SSD_{A} = \sum_{k=1}^K\sum_{l\ne k}^K\frac{\sum_{i=1}^{N_k}\sum_{j=1}^{N_l}\delta_{ij}^2}{N_k+N_l}
\]</span></p>
<p><img src="media/amova_ssda.png" width="100" style="display: block; margin: auto;" /></p>
<p>These sums of squares in this context enter directly into a traditional ANOVA table . From here, it is identical to a normal ANOVA analysis. We have degrees of freedom, mean squares, and variance components. The AMOVA itself, due to the way we sample the individuals and populations is a random-effects model. Our sampling typically consists of us going out and sampling a portion of the potential populations that exist rather than sampling all specified populations. As a statistical consequence, this means that the variance within (the error term) and among (the treatment variance) have to be corrected because we are taking only a sample from all potential populations. For a 1-level analysis, we can perform this in R by first setting up the data as a distance matrix and a vector of population assignments (it appears that the values need to be either numeric or as a factor for populations, though at the time of this writing, I could not get a factor representation to work properly).</p>
<pre class="sourceCode r"><code class="sourceCode r">D &lt;-<span class="st"> </span><span class="kw">genetic_distance</span>(arapat, <span class="dt">stratum=</span><span class="st">&quot;Population&quot;</span>, <span class="dt">mode=</span><span class="st">&quot;AMOVA&quot;</span>)
D &lt;-<span class="st"> </span><span class="kw">as.dist</span>( D )
pop &lt;-<span class="st"> </span><span class="kw">factor</span>( <span class="kw">as.numeric</span>( arapat<span class="op">$</span>Population ) )</code></pre>
<p>and then using the <code>amova()</code> function from the pegas library (there are many different implementations of this kind of analysis, decompose the variance into and fill out the AMOVA table as:</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(pegas)
fit &lt;-<span class="st"> </span><span class="kw">amova</span>( D <span class="op">~</span><span class="st"> </span>pop, <span class="dt">nperm=</span><span class="dv">1000</span> )
fit</code></pre>
<pre><code>## 
##  Analysis of Molecular Variance
## 
## Call: amova(formula = D ~ pop, nperm = 1000)
## 
##            SSD       MSD  df
## pop   2304.694 60.649831  38
## Error  771.721  2.381855 324
## Total 3076.415  8.498383 362
## 
## Variance components:
##       sigma2 P.value
## pop   6.2701       0
## Error 2.3819        
## 
## Phi-statistics:
## pop.in.GLOBAL 
##     0.7247025 
## 
## Variance coefficients:
##        a 
## 9.293026</code></pre>
<p>This gives us the standard anova table and an estimate of the probability associated with the variance component representing among-population variance, <span class="math inline">\(\sigma_A^2\)</span>.<br />
The estimated variance components of this model, we can estimate a structure statistic, <span class="math inline">\(\Phi_{ST}\)</span>, which for a 1-level analysis is</p>
<p><span class="math display">\[
\Phi_{ST} = \frac{\sigma_A^2}{\sigma_A^2+\sigma_W^2}
\]</span></p>
<p>and from the output of the amova() function can be estimated as (don’t know why this isn’t done automagically)</p>
<pre class="sourceCode r"><code class="sourceCode r">PhiST &lt;-<span class="st"> </span><span class="dv">1</span> <span class="op">-</span><span class="st"> </span>fit<span class="op">$</span>varcoef<span class="op">/</span>(fit<span class="op">$</span>varcoef<span class="op">+</span>fit<span class="op">$</span>varcomp[<span class="dv">2</span>,<span class="dv">1</span>])
PhiST</code></pre>
<pre><code>##         a 
## 0.2040154</code></pre>
<p>Which means that roughly % of the genetic variation observed in these data can be attributed to individuals being assigned to different populations.</p>
<div id="final-thoughts-on-structure" class="section level3">
<h3><span class="header-section-number">2.11.1</span> Final Thoughts on Structure</h3>
<p>The estimation of genetic structure is a fundamental endeavor in population genetics that at times can be given a bit more weight than it may warrant. These parameters are simply estimates of a magnitude of structure in relation to either the degree to which populations have gone to fixation or as a statistical decomposition of raw variation. The important component here is that there are a lot of ways that a set of population histories may result in the same amount of genetic variation. The important point here is that simply looking at the magnitude of variation among strata does not allow us to differentiate among alternative demographic histories.</p>
</div>
</div>
<div id="questions-1" class="section level2">
<h2><span class="header-section-number">2.12</span> Questions</h2>
<ol style="list-style-type: decimal">
<li><p>Using the <em>arapat</em> data set, create a map of allele frequencies for the loci “EF” an “ZMP”. Are there patterns in allele frequencies across the landscape that suggest spatial structuring?</p></li>
<li><p>Hardy-Weinberg Equilibrium assumes that the genotype frequencies at a locus are dictated only by the allele frequencies. As such, test the null hypothesis <span class="math inline">\(H_O: ZMP is in HWE&quot;\)</span> using the <span class="math inline">\(\chi^2\)</span> approximation.</p></li>
<li><p>Create a plot of allele frequencies for the LTRS locus allele “01” along Latitude. Does this help interpret spatial structure.</p></li>
<li><p>Partition out the populations in the <em>arapat</em> data set into those with <code>Species==&quot;Peninsula&quot;</code> and <code>Species==&quot;Cape&quot;</code> and perform an analysis of molecular variance on them individually. Which group of populations has more genetic structure?</p></li>
</ol>

</div>
</div>
<div class="footnotes">
<hr />
<ol start="1">
<li id="fn1"><p>No need to use negative numbers or any other kind of metric, it is just missing as if you didn’t get the observation.<a href="genetic-data.html#fnref1" class="footnote-back">↩</a></p></li>
<li id="fn2"><p>The <code>NA</code> in the <span class="math inline">\(H_{ES}\)</span> parameter is because there are no samples in one of the populations and a harmonic mean with a zero in it results in a divide-by-zero error.<a href="genetic-data.html#fnref2" class="footnote-back">↩</a></p></li>
<li id="fn3"><p>When we have more than 2 alleles at a locus, it is often easier to estimate the part that is not homozygote rather than adding up for example <span class="math inline">\(2pq + 2pr + 2ps + 2qr + 2qs + 2rs\)</span> to estimate heterozygotes.<a href="genetic-data.html#fnref3" class="footnote-back">↩</a></p></li>
</ol>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="spatial-data.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="resistance-models.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": false,
"twitter": false,
"google": false,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "section",
"scroll_highlight": true
},
"search": true
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:" && /^https?:/.test(src))
      src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
